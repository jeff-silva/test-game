import{g as k,X as _,Y as Xe,Z as Ke,_ as Ne,u as ue,$ as Je,c as Ye,a0 as Fe,M as De,a1 as qe,A as Pe}from"./DQ4UCc7_.js";import{c as te}from"./Cpj98o6Y.js";const le=new Map,_e=5,ee=(E,x=!1)=>{if(!le.has(E))le.set(E,1);else{const v=le.get(E);if(typeof v>"u"||v>=_e)return;le.set(E,v+1)}x?console.error(`%c [enable3d] ${E} `,"background: #222; color: #bada55"):console.warn(`%c [enable3d] ${E} `,"background: #222; color: #bada55")};var Ce={},me={};Object.defineProperty(me,"__esModule",{value:!0});me.VERSION=void 0;me.VERSION="0.0.5";/**
 * @package      npmjs.com/package/@yandeu/events (events.min.js)
 *
 * @author       Arnout Kazemier (https://github.com/3rd-Eden)
 * @copyright    Copyright (c) 2014 Arnout Kazemier
 * @license      {@link https://github.com/primus/eventemitter3/blob/master/LICENSE|MIT}
 *
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/yandeu/events
 * @license      {@link https://github.com/yandeu/events/blob/master/LICENSE|MIT}
 */var He=te&&te.__spreadArray||function(E,x){for(var v=0,M=x.length,h=E.length;v<M;v++,h++)E[h]=x[v];return E};Object.defineProperty(Ce,"__esModule",{value:!0});var et=Ce.Events=void 0,tt=me,nt=function(){function E(x,v,M){M===void 0&&(M=!1),this.fn=x,this.context=v,this.once=M}return E}(),Le=function(E,x,v,M,h){if(typeof v!="function")throw new TypeError("The listener must be a function");var e=new nt(v,M||E,h);return E._events.has(x)?E._events.get(x).fn?E._events.set(x,[E._events.get(x),e]):E._events.get(x).push(e):(E._events.set(x,e),E._eventsCount++),E},fe=function(E,x){--E._eventsCount===0?E._events=new Map:E._events.delete(x)},it=function(){function E(){this._events=new Map,this._eventsCount=0}return Object.defineProperty(E,"VERSION",{get:function(){return tt.VERSION},enumerable:!1,configurable:!0}),E.prototype.eventNames=function(){return Array.from(this._events.keys())},E.prototype.listeners=function(x){var v=this._events.get(x);if(!v)return[];if(v.fn)return[v.fn];for(var M=0,h=v.length,e=new Array(h);M<h;M++)e[M]=v[M].fn;return e},E.prototype.listenerCount=function(x){var v=this._events.get(x);return v?v.fn?1:v.length:0},E.prototype.emit=function(x){for(var v,M,h=[],e=1;e<arguments.length;e++)h[e-1]=arguments[e];if(!this._events.has(x))return!1;var l=this._events.get(x),i;if(l.fn)return l.once&&this.removeListener(x,l.fn,void 0,!0),(v=l.fn).call.apply(v,He([l.context],h)),!0;var a=l.length;for(i=0;i<a;i++)l[i].once&&this.removeListener(x,l[i].fn,void 0,!0),(M=l[i].fn).call.apply(M,He([l[i].context],h));return!0},E.prototype.on=function(x,v,M){return Le(this,x,v,M,!1)},E.prototype.once=function(x,v,M){return Le(this,x,v,M,!0)},E.prototype.removeListener=function(x,v,M,h){if(!this._events.has(x))return this;if(!v)return fe(this,x),this;var e=this._events.get(x);if(e.fn)e.fn===v&&(!h||e.once)&&(!M||e.context===M)&&fe(this,x);else{for(var l=0,i=[],a=e.length;l<a;l++)(e[l].fn!==v||h&&!e[l].once||M&&e[l].context!==M)&&i.push(e[l]);i.length?this._events.set(x,i.length===1?i[0]:i):fe(this,x)}return this},E.prototype.removeAllListeners=function(x){return x?this._events.delete(x)&&fe(this,x):(this._events=new Map,this._eventsCount=0),this},Object.defineProperty(E.prototype,"off",{get:function(){return this.removeListener},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"addListener",{get:function(){return this.on},enumerable:!1,configurable:!0}),E}();et=Ce.Events=it;/**
 * @author       Kevin Lee (https://github.com/InfiniteLee)
 * @copyright    Copyright (c) 2020 Kevin Lee; Project Url: https://github.com/InfiniteLee/three-to-ammo
 * @license      {@link https://github.com/InfiniteLee/three-to-ammo/blob/master/LICENSE|MPL-2.0}
 */const ne={BOX:"box",CYLINDER:"cylinder",SPHERE:"sphere",CAPSULE:"capsule",CONE:"cone",HULL:"hull",HACD:"hacd",VHACD:"vhacd",MESH:"mesh",HEIGHTFIELD:"heightfield"},ie={ALL:"all",MANUAL:"manual"},yt=function(){const E=new k,x=new k,v=new _;return function(M,h,e,l={}){if(l.type=ne.HULL,ve(l),l.fit===ie.MANUAL)return console.warn("cannot use fit: manual with type: hull"),null;const i=Ae(M,h),a=new Ammo.btVector3,f=new Ammo.btConvexHullShape;f.setMargin(l.margin),x.addVectors(i.max,i.min).multiplyScalar(.5);let r=0;for(let n=0;n<M.length;n++)r+=M[n].length/3;const c=l.hullMaxVertices||1e5;r>c&&console.warn(`too many vertices for hull shape; sampling ~${c} from ~${r} vertices`);const o=Math.min(1,c/r);for(let n=0;n<M.length;n++){const s=M[n];v.fromArray(h[n]);for(let u=0;u<s.length;u+=3){const p=n===M.length-1&&u===s.length-3;(Math.random()<=o||p)&&(E.set(s[u],s[u+1],s[u+2]).applyMatrix4(v).sub(x),a.setValue(E.x,E.y,E.z),f.addPoint(a,p))}}let t=f;if(f.getNumVertices()>=100){const n=new Ammo.btShapeHull(f);n.buildHull(l.margin),Ammo.destroy(f),t=new Ammo.btConvexHullShape(Ammo.getPointer(n.getVertexPointer()),n.numVertices()),Ammo.destroy(n)}return Ammo.destroy(a),pe(t,l,ge(e,l)),t}}(),St=function(){const E=new k,x=new k,v=new _;return function(M,h,e,l,i={}){if(i.type=ne.HACD,ve(i),i.fit===ie.MANUAL)return console.warn("cannot use fit: manual with type: hacd"),[];if(!Ammo.hasOwnProperty("HACD"))return console.warn("HACD unavailable in included build of Ammo.js. Visit https://github.com/mozillareality/ammo.js for the latest version."),[];const a=Ae(M,h);ge(l,i);let f=0,r=0;x.addVectors(a.max,a.min).multiplyScalar(.5);for(let S=0;S<M.length;S++)f+=M[S].length/3,e&&e[S]?r+=e[S].length/3:r+=M[S].length/9;const c=new Ammo.HACD;i.hasOwnProperty("compacityWeight")&&c.SetCompacityWeight(i.compacityWeight),i.hasOwnProperty("volumeWeight")&&c.SetVolumeWeight(i.volumeWeight),i.hasOwnProperty("nClusters")&&c.SetNClusters(i.nClusters),i.hasOwnProperty("nVerticesPerCH")&&c.SetNVerticesPerCH(i.nVerticesPerCH),i.hasOwnProperty("concavity")&&c.SetConcavity(i.concavity);const o=Ammo._malloc(f*3*8),t=Ammo._malloc(r*3*4);c.SetPoints(o),c.SetTriangles(t),c.SetNPoints(f),c.SetNTriangles(r);let n=o/8,s=t/4;for(let S=0;S<M.length;S++){const w=M[S];v.fromArray(h[S]);for(let C=0;C<w.length;C+=3)E.set(w[C+0],w[C+1],w[C+2]).applyMatrix4(v).sub(x),Ammo.HEAPF64[n+0]=E.x,Ammo.HEAPF64[n+1]=E.y,Ammo.HEAPF64[n+2]=E.z,n+=3;if(e[S]){const C=e[S];for(let m=0;m<C.length;m++)Ammo.HEAP32[s]=C[m],s++}else for(let C=0;C<w.length/3;C++)Ammo.HEAP32[s]=C,s++}c.Compute(),Ammo._free(o),Ammo._free(t);const u=c.GetNClusters(),p=[];for(let S=0;S<u;S++){const w=new Ammo.btConvexHullShape;w.setMargin(i.margin);const C=c.GetNPointsCH(S),m=c.GetNTrianglesCH(S),g=Ammo._malloc(C*3*8),y=Ammo._malloc(m*3*4);c.GetCH(S,g,y);const d=g/8;for(let A=0;A<C;A++){const P=new Ammo.btVector3,T=Ammo.HEAPF64[d+A*3+0],V=Ammo.HEAPF64[d+A*3+1],I=Ammo.HEAPF64[d+A*3+2];P.setValue(T,V,I),w.addPoint(P,A===C-1),Ammo.destroy(P)}pe(),p.push(w)}return p}}(),wt=function(){const E=new k,x=new k,v=new _;return function(M,h,e,l,i={}){if(i.type=ne.VHACD,ve(i),i.fit===ie.MANUAL)return console.warn("cannot use fit: manual with type: vhacd"),[];if(!Ammo.hasOwnProperty("VHACD"))return console.warn("VHACD unavailable in included build of Ammo.js. Visit https://github.com/mozillareality/ammo.js for the latest version."),[];const a=Ae(M,h);ge(l,i);let f=0,r=0;x.addVectors(a.max,a.min).multiplyScalar(.5);for(let C=0;C<M.length;C++)f+=M[C].length/3,e&&e[C]?r+=e[C].length/3:r+=M[C].length/9;const c=new Ammo.VHACD,o=new Ammo.Parameters;i.hasOwnProperty("resolution")&&o.set_m_resolution(i.resolution),i.hasOwnProperty("depth")&&o.set_m_depth(i.depth),i.hasOwnProperty("concavity")&&o.set_m_concavity(i.concavity),i.hasOwnProperty("planeDownsampling")&&o.set_m_planeDownsampling(i.planeDownsampling),i.hasOwnProperty("convexhullDownsampling")&&o.set_m_convexhullDownsampling(i.convexhullDownsampling),i.hasOwnProperty("alpha")&&o.set_m_alpha(i.alpha),i.hasOwnProperty("beta")&&o.set_m_beta(i.beta),i.hasOwnProperty("gamma")&&o.set_m_gamma(i.gamma),i.hasOwnProperty("pca")&&o.set_m_pca(i.pca),i.hasOwnProperty("mode")&&o.set_m_mode(i.mode),i.hasOwnProperty("maxNumVerticesPerCH")&&o.set_m_maxNumVerticesPerCH(i.maxNumVerticesPerCH),i.hasOwnProperty("minVolumePerCH")&&o.set_m_minVolumePerCH(i.minVolumePerCH),i.hasOwnProperty("convexhullApproximation")&&o.set_m_convexhullApproximation(i.convexhullApproximation),i.hasOwnProperty("oclAcceleration")&&o.set_m_oclAcceleration(i.oclAcceleration);const t=Ammo._malloc(f*3*8+3),n=Ammo._malloc(r*3*4);let s=t/8,u=n/4;for(let C=0;C<M.length;C++){const m=M[C];v.fromArray(h[C]);for(let g=0;g<m.length;g+=3)E.set(m[g+0],m[g+1],m[g+2]).applyMatrix4(v).sub(x),Ammo.HEAPF64[s+0]=E.x,Ammo.HEAPF64[s+1]=E.y,Ammo.HEAPF64[s+2]=E.z,s+=3;if(e[C]){const g=e[C];for(let y=0;y<g.length;y++)Ammo.HEAP32[u]=g[y],u++}else for(let g=0;g<m.length/3;g++)Ammo.HEAP32[u]=g,u++}c.Compute(t,3,f,n,3,r,o),Ammo._free(t),Ammo._free(n);const p=c.GetNConvexHulls(),S=[],w=new Ammo.ConvexHull;for(let C=0;C<p;C++){c.GetConvexHull(C,w);const m=w.get_m_nPoints();w.get_m_points();const g=new Ammo.btConvexHullShape;g.setMargin(i.margin);for(let y=0;y<m;y++){const d=new Ammo.btVector3,A=w.get_m_points(y*3+0),P=w.get_m_points(y*3+1),T=w.get_m_points(y*3+2);d.setValue(A,P,T),g.addPoint(d,y===m-1),Ammo.destroy(d)}pe(),S.push(g)}return Ammo.destroy(w),Ammo.destroy(c),S}}(),Pt=function(){const E=new k,x=new k,v=new k,M=new _;return function(h,e,l,i,a={}){if(a.type=ne.MESH,ve(a),a.fit===ie.MANUAL)return console.warn("cannot use fit: manual with type: mesh"),null;const f=ge(i,a),r=new Ammo.btVector3,c=new Ammo.btVector3,o=new Ammo.btVector3,t=new Ammo.btTriangleMesh(!0,!1);for(let u=0;u<h.length;u++){const p=h[u],S=l[u]?l[u]:null;if(M.fromArray(e[u]),S)for(let w=0;w<S.length;w+=3){const C=S[w]*3,m=S[w+1]*3,g=S[w+2]*3;E.set(p[C],p[C+1],p[C+2]).applyMatrix4(M),x.set(p[m],p[m+1],p[m+2]).applyMatrix4(M),v.set(p[g],p[g+1],p[g+2]).applyMatrix4(M),r.setValue(E.x,E.y,E.z),c.setValue(x.x,x.y,x.z),o.setValue(v.x,v.y,v.z),t.addTriangle(r,c,o,!1)}else for(let w=0;w<p.length;w+=9)E.set(p[w+0],p[w+1],p[w+2]).applyMatrix4(M),x.set(p[w+3],p[w+4],p[w+5]).applyMatrix4(M),v.set(p[w+6],p[w+7],p[w+8]).applyMatrix4(M),r.setValue(E.x,E.y,E.z),c.setValue(x.x,x.y,x.z),o.setValue(v.x,v.y,v.z),t.addTriangle(r,c,o,!1)}const n=new Ammo.btVector3(f.x,f.y,f.z);t.setScaling(n),Ammo.destroy(n);let s;return a.concave?s=new Ammo.btBvhTriangleMeshShape(t,!0,!0):s=new Ammo.btConvexTriangleMeshShape(t,!0),s.resources=[t],Ammo.destroy(r),Ammo.destroy(c),Ammo.destroy(o),pe(),s}}();function ve(E){E.type=E.type||ne.HULL,E.margin=E.hasOwnProperty("margin")?E.margin:.01}const pe=function(E,x,v){},Ct=function(){const E=new _;return function(x,v,M){parseInt(Xe)>=123?E.copy(x.matrixWorld).invert():E.getInverse(x.matrixWorld),new k().setFromMatrixScale(x.matrixWorld),x.traverse(e=>{const l=new _;e.isMesh&&(v.includeInvisible||e.el&&e.el.object3D.visible||e.visible)&&(e===x?l.identity():(e.updateWorldMatrix(!0),l.multiplyMatrices(E,e.matrixWorld)),M(e.geometry.isBufferGeometry?e.geometry.attributes.position.array:e.geometry.vertices,l.elements,e.geometry.index?e.geometry.index.array:null))})}}(),ge=function(){const E=new _;return function(x,v={}){const M=new k(1,1,1);return v.fit===ie.ALL&&(E.fromArray(x),M.setFromMatrixScale(E)),M}}();(function(){const E=new k;return function(x,v,M){let h=0,{x:e,y:l,z:i}=M.getCenter(E);return Ue(x,v,a=>{const f=e-a.x,r=l-a.y,c=i-a.z;h=Math.max(h,f*f+r*r+c*c)}),Math.sqrt(h)}})();const Ae=function(E,x){const v=new Ke;let M=1/0,h=1/0,e=1/0,l=-1/0,i=-1/0,a=-1/0;return v.min.set(0,0,0),v.max.set(0,0,0),Ue(E,x,f=>{f.x<M&&(M=f.x),f.y<h&&(h=f.y),f.z<e&&(e=f.z),f.x>l&&(l=f.x),f.y>i&&(i=f.y),f.z>a&&(a=f.z)}),v.min.set(M,h,e),v.max.set(l,i,a),v},Ue=function(){const E=new k,x=new _;return function(v,M,h){for(let e=0;e<v.length;e++){x.fromArray(M[e]);for(let l=0;l<v[e].length;l+=3)E.set(v[e][l],v[e][l+1],v[e][l+2]).applyMatrix4(x),h(E)}}}(),he=0,rt=1,st=new k,Oe=new Ne,Se=new ue,ke=new k,ce=new Je;class at{constructor(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new be,this.unassigned=new be,this.vertices=[]}setFromPoints(x){if(x.length>=4){this.makeEmpty();for(let v=0,M=x.length;v<M;v++)this.vertices.push(new ot(x[v]));this.compute()}return this}setFromObject(x){const v=[];return x.updateMatrixWorld(!0),x.traverse(function(M){const h=M.geometry;if(h!==void 0){const e=h.attributes.position;if(e!==void 0)for(let l=0,i=e.count;l<i;l++){const a=new k;a.fromBufferAttribute(e,l).applyMatrix4(M.matrixWorld),v.push(a)}}}),this.setFromPoints(v)}containsPoint(x){const v=this.faces;for(let M=0,h=v.length;M<h;M++)if(v[M].distanceToPoint(x)>this.tolerance)return!1;return!0}intersectRay(x,v){const M=this.faces;let h=-1/0,e=1/0;for(let l=0,i=M.length;l<i;l++){const a=M[l],f=a.distanceToPoint(x.origin),r=a.normal.dot(x.direction);if(f>0&&r>=0)return null;const c=r!==0?-f/r:0;if(!(c<=0)&&(r>0?e=Math.min(c,e):h=Math.max(c,h),h>e))return null}return h!==-1/0?x.at(h,v):x.at(e,v),v}intersectsRay(x){return this.intersectRay(x,st)!==null}makeEmpty(){return this.faces=[],this.vertices=[],this}addVertexToFace(x,v){return x.face=v,v.outside===null?this.assigned.append(x):this.assigned.insertBefore(v.outside,x),v.outside=x,this}removeVertexFromFace(x,v){return x===v.outside&&(x.next!==null&&x.next.face===v?v.outside=x.next:v.outside=null),this.assigned.remove(x),this}removeAllVerticesFromFace(x){if(x.outside!==null){const v=x.outside;let M=x.outside;for(;M.next!==null&&M.next.face===x;)M=M.next;return this.assigned.removeSubList(v,M),v.prev=M.next=null,x.outside=null,v}}deleteFaceVertices(x,v){const M=this.removeAllVerticesFromFace(x);if(M!==void 0)if(v===void 0)this.unassigned.appendChain(M);else{let h=M;do{const e=h.next;v.distanceToPoint(h.point)>this.tolerance?this.addVertexToFace(h,v):this.unassigned.append(h),h=e}while(h!==null)}return this}resolveUnassignedPoints(x){if(this.unassigned.isEmpty()===!1){let v=this.unassigned.first();do{const M=v.next;let h=this.tolerance,e=null;for(let l=0;l<x.length;l++){const i=x[l];if(i.mark===he){const a=i.distanceToPoint(v.point);if(a>h&&(h=a,e=i),h>1e3*this.tolerance)break}}e!==null&&this.addVertexToFace(v,e),v=M}while(v!==null)}return this}computeExtremes(){const x=new k,v=new k,M=[],h=[];for(let e=0;e<3;e++)M[e]=h[e]=this.vertices[0];x.copy(this.vertices[0].point),v.copy(this.vertices[0].point);for(let e=0,l=this.vertices.length;e<l;e++){const i=this.vertices[e],a=i.point;for(let f=0;f<3;f++)a.getComponent(f)<x.getComponent(f)&&(x.setComponent(f,a.getComponent(f)),M[f]=i);for(let f=0;f<3;f++)a.getComponent(f)>v.getComponent(f)&&(v.setComponent(f,a.getComponent(f)),h[f]=i)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(x.x),Math.abs(v.x))+Math.max(Math.abs(x.y),Math.abs(v.y))+Math.max(Math.abs(x.z),Math.abs(v.z))),{min:M,max:h}}computeInitialHull(){const x=this.vertices,v=this.computeExtremes(),M=v.min,h=v.max;let e=0,l=0;for(let o=0;o<3;o++){const t=h[o].point.getComponent(o)-M[o].point.getComponent(o);t>e&&(e=t,l=o)}const i=M[l],a=h[l];let f,r;e=0,Oe.set(i.point,a.point);for(let o=0,t=this.vertices.length;o<t;o++){const n=x[o];if(n!==i&&n!==a){Oe.closestPointToPoint(n.point,!0,ke);const s=ke.distanceToSquared(n.point);s>e&&(e=s,f=n)}}e=-1,Se.setFromCoplanarPoints(i.point,a.point,f.point);for(let o=0,t=this.vertices.length;o<t;o++){const n=x[o];if(n!==i&&n!==a&&n!==f){const s=Math.abs(Se.distanceToPoint(n.point));s>e&&(e=s,r=n)}}const c=[];if(Se.distanceToPoint(r.point)<0){c.push(J.create(i,a,f),J.create(r,a,i),J.create(r,f,a),J.create(r,i,f));for(let o=0;o<3;o++){const t=(o+1)%3;c[o+1].getEdge(2).setTwin(c[0].getEdge(t)),c[o+1].getEdge(1).setTwin(c[t+1].getEdge(0))}}else{c.push(J.create(i,f,a),J.create(r,i,a),J.create(r,a,f),J.create(r,f,i));for(let o=0;o<3;o++){const t=(o+1)%3;c[o+1].getEdge(2).setTwin(c[0].getEdge((3-o)%3)),c[o+1].getEdge(0).setTwin(c[t+1].getEdge(1))}}for(let o=0;o<4;o++)this.faces.push(c[o]);for(let o=0,t=x.length;o<t;o++){const n=x[o];if(n!==i&&n!==a&&n!==f&&n!==r){e=this.tolerance;let s=null;for(let u=0;u<4;u++){const p=this.faces[u].distanceToPoint(n.point);p>e&&(e=p,s=this.faces[u])}s!==null&&this.addVertexToFace(n,s)}}return this}reindexFaces(){const x=[];for(let v=0;v<this.faces.length;v++){const M=this.faces[v];M.mark===he&&x.push(M)}return this.faces=x,this}nextVertexToAdd(){if(this.assigned.isEmpty()===!1){let x,v=0;const M=this.assigned.first().face;let h=M.outside;do{const e=M.distanceToPoint(h.point);e>v&&(v=e,x=h),h=h.next}while(h!==null&&h.face===M);return x}}computeHorizon(x,v,M,h){this.deleteFaceVertices(M),M.mark=rt;let e;v===null?e=v=M.getEdge(0):e=v.next;do{const l=e.twin,i=l.face;i.mark===he&&(i.distanceToPoint(x)>this.tolerance?this.computeHorizon(x,l,i,h):h.push(e)),e=e.next}while(e!==v);return this}addAdjoiningFace(x,v){const M=J.create(x,v.tail(),v.head());return this.faces.push(M),M.getEdge(-1).setTwin(v.twin),M.getEdge(0)}addNewFaces(x,v){this.newFaces=[];let M=null,h=null;for(let e=0;e<v.length;e++){const l=v[e],i=this.addAdjoiningFace(x,l);M===null?M=i:i.next.setTwin(h),this.newFaces.push(i.face),h=i}return M.next.setTwin(h),this}addVertexToHull(x){const v=[];return this.unassigned.clear(),this.removeVertexFromFace(x,x.face),this.computeHorizon(x.point,null,x.face,v),this.addNewFaces(x,v),this.resolveUnassignedPoints(this.newFaces),this}cleanup(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this}compute(){let x;for(this.computeInitialHull();(x=this.nextVertexToAdd())!==void 0;)this.addVertexToHull(x);return this.reindexFaces(),this.cleanup(),this}}class J{constructor(){this.normal=new k,this.midpoint=new k,this.area=0,this.constant=0,this.outside=null,this.mark=he,this.edge=null}static create(x,v,M){const h=new J,e=new we(x,h),l=new we(v,h),i=new we(M,h);return e.next=i.prev=l,l.next=e.prev=i,i.next=l.prev=e,h.edge=e,h.compute()}getEdge(x){let v=this.edge;for(;x>0;)v=v.next,x--;for(;x<0;)v=v.prev,x++;return v}compute(){const x=this.edge.tail(),v=this.edge.head(),M=this.edge.next.head();return ce.set(x.point,v.point,M.point),ce.getNormal(this.normal),ce.getMidpoint(this.midpoint),this.area=ce.getArea(),this.constant=this.normal.dot(this.midpoint),this}distanceToPoint(x){return this.normal.dot(x)-this.constant}}class we{constructor(x,v){this.vertex=x,this.prev=null,this.next=null,this.twin=null,this.face=v}head(){return this.vertex}tail(){return this.prev?this.prev.vertex:null}length(){const x=this.head(),v=this.tail();return v!==null?v.point.distanceTo(x.point):-1}lengthSquared(){const x=this.head(),v=this.tail();return v!==null?v.point.distanceToSquared(x.point):-1}setTwin(x){return this.twin=x,x.twin=this,this}}class ot{constructor(x){this.point=x,this.prev=null,this.next=null,this.face=null}}class be{constructor(){this.head=null,this.tail=null}first(){return this.head}last(){return this.tail}clear(){return this.head=this.tail=null,this}insertBefore(x,v){return v.prev=x.prev,v.next=x,v.prev===null?this.head=v:v.prev.next=v,x.prev=v,this}insertAfter(x,v){return v.prev=x,v.next=x.next,v.next===null?this.tail=v:v.next.prev=v,x.next=v,this}append(x){return this.head===null?this.head=x:this.tail.next=x,x.prev=this.tail,x.next=null,this.tail=x,this}appendChain(x){for(this.head===null?this.head=x:this.tail.next=x,x.prev=this.tail;x.next!==null;)x=x.next;return this.tail=x,this}remove(x){return x.prev===null?this.head=x.next:x.prev.next=x.next,x.next===null?this.tail=x.prev:x.next.prev=x.prev,this}removeSubList(x,v){return x.prev===null?this.head=v.next:x.prev.next=v.next,v.next===null?this.tail=x.prev:v.next.prev=x.prev,this}isEmpty(){return this.head===null}}class lt extends Ye{constructor(x=[]){super();const v=[],M=[],e=new at().setFromPoints(x).faces;for(let l=0;l<e.length;l++){const i=e[l];let a=i.edge;do{const f=a.head().point;v.push(f.x,f.y,f.z),M.push(i.normal.x,i.normal.y,i.normal.z),a=a.next}while(a!==i.edge)}this.setAttribute("position",new Fe(v,3)),this.setAttribute("normal",new Fe(M,3))}}const We=E=>{const x=window.THREE&&window.THREE.ConvexGeometry?window.THREE.ConvexGeometry:lt;return new x(E)},q=function(E,x){this.minSizeForBreak=E||1.4,this.smallDelta=x||1e-4,this.tempLine1=new Ne,this.tempPlane1=new ue,this.tempPlane2=new ue,this.tempPlane_Cut=new ue,this.tempCM1=new k,this.tempCM2=new k,this.tempVector3=new k,this.tempVector3_2=new k,this.tempVector3_3=new k,this.tempVector3_P0=new k,this.tempVector3_P1=new k,this.tempVector3_P2=new k,this.tempVector3_N0=new k,this.tempVector3_N1=new k,this.tempVector3_AB=new k,this.tempVector3_CB=new k,this.tempResultObjects={object1:null,object2:null},this.segments=[];for(var v=30*30,M=0;M<v;M++)this.segments[M]=!1};q.prototype={constructor:q,prepareBreakableObject:function(E,x,v,M,h){E.geometry.isBufferGeometry||console.error("THREE.ConvexObjectBreaker.prepareBreakableObject(): Parameter object must have a BufferGeometry."),E.userData.ammoPhysicsData={};var e=E.userData.ammoPhysicsData;e.mass=x,e.velocity=v.clone(),e.angularVelocity=M.clone(),e.breakable=h},subdivideByImpact:function(E,x,v,M,h){var e=[],l=this.tempPlane1,i=this.tempPlane2;this.tempVector3.addVectors(x,v),l.setFromCoplanarPoints(x,E.position,this.tempVector3);var a=h+M,f=this;function r(c,o,t,n){if(Math.random()<n*.05||n>a){e.push(c);return}var s=Math.PI;n===0?(i.normal.copy(l.normal),i.constant=l.constant):n<=M?(s=(t-o)*(.2+.6*Math.random())+o,f.tempVector3_2.copy(E.position).sub(x).applyAxisAngle(v,s).add(x),i.setFromCoplanarPoints(x,f.tempVector3,f.tempVector3_2)):(s=(.5*(n&1)+.2*(2-Math.random()))*Math.PI,f.tempVector3_2.copy(x).sub(c.position).applyAxisAngle(v,s).add(c.position),f.tempVector3_3.copy(v).add(c.position),i.setFromCoplanarPoints(c.position,f.tempVector3_3,f.tempVector3_2)),f.cutByPlane(c,i,f.tempResultObjects);var u=f.tempResultObjects.object1,p=f.tempResultObjects.object2;u&&r(u,o,s,n+1),p&&r(p,s,t,n+1)}return r(E,0,2*Math.PI,0),e},cutByPlane:function(E,x,v){var M=E.geometry,h=M.attributes.position.array,e=M.attributes.normal.array,l=h.length/3,i=l/3,a=M.getIndex();a&&(a=a.array,i=a.length/3);function f(U,de){var re=U*3+de;return a?a[re]:re}for(var r=[],c=[],o=this.smallDelta,t=l*l,n=0;n<t;n++)this.segments[n]=!1;for(var s=this.tempVector3_P0,u=this.tempVector3_P1,p=this.tempVector3_N0,S=this.tempVector3_N1,n=0;n<i-1;n++){var w=f(n,0),C=f(n,1),m=f(n,2);p.set(e[w],e[w]+1,e[w]+2);for(var g=n+1;g<i;g++){var y=f(g,0),d=f(g,1),A=f(g,2);S.set(e[y],e[y]+1,e[y]+2);var P=1-p.dot(S)<o;P&&(w===y||w===d||w===A?C===y||C===d||C===A?(this.segments[w*l+C]=!0,this.segments[C*l+w]=!0):(this.segments[m*l+w]=!0,this.segments[w*l+m]=!0):(C===y||C===d||C===A)&&(this.segments[m*l+C]=!0,this.segments[C*l+m]=!0))}}var T=this.tempPlane_Cut;E.updateMatrix(),q.transformPlaneToLocalSpace(x,E.matrix,T);for(var n=0;n<i;n++)for(var V=f(n,0),I=f(n,1),R=f(n,2),B=0;B<3;B++){var D=B===0?V:B===1?I:R,F=B===0?I:B===1?R:V,L=this.segments[D*l+F];if(!L){this.segments[D*l+F]=!0,this.segments[F*l+D]=!0,s.set(h[3*D],h[3*D+1],h[3*D+2]),u.set(h[3*F],h[3*F+1],h[3*F+2]);var O=0,W=T.distanceToPoint(s);W>o?(O=2,c.push(s.clone())):W<-o?(O=1,r.push(s.clone())):(O=3,r.push(s.clone()),c.push(s.clone()));var b=0,W=T.distanceToPoint(u);if(W>o?(b=2,c.push(u.clone())):W<-o?(b=1,r.push(u.clone())):(b=3,r.push(u.clone()),c.push(u.clone())),O===1&&b===2||O===2&&b===1){this.tempLine1.start.copy(s),this.tempLine1.end.copy(u);var z=new k;if(z=T.intersectLine(this.tempLine1,z),z===void 0)return console.error("Internal error: segment does not intersect plane."),v.segmentedObject1=null,v.segmentedObject2=null,0;r.push(z),c.push(z.clone())}}}var G=E.userData.ammoPhysicsData.mass*.5;this.tempCM1.set(0,0,0);var X=0,$=r.length;if($>0){for(var n=0;n<$;n++)this.tempCM1.add(r[n]);this.tempCM1.divideScalar($);for(var n=0;n<$;n++){var H=r[n];H.sub(this.tempCM1),X=Math.max(X,H.x,H.y,H.z)}this.tempCM1.add(E.position)}this.tempCM2.set(0,0,0);var Q=0,N=c.length;if(N>0){for(var n=0;n<N;n++)this.tempCM2.add(c[n]);this.tempCM2.divideScalar(N);for(var n=0;n<N;n++){var H=c[n];H.sub(this.tempCM2),Q=Math.max(Q,H.x,H.y,H.z)}this.tempCM2.add(E.position)}var K=null,j=null,Z=0;if($>4)try{K=new De(We(r),E.material),K.position.copy(this.tempCM1),K.quaternion.copy(E.quaternion),K.userData=E.userData,this.prepareBreakableObject(K,G,E.userData.ammoPhysicsData.velocity,E.userData.ammoPhysicsData.angularVelocity,2*X>this.minSizeForBreak),Z++}catch(U){ee("Error in ConvexObjectBreaker.ts",!0),ee(U,!0)}if(N>4)try{j=new De(We(c),E.material),j.position.copy(this.tempCM2),j.quaternion.copy(E.quaternion),j.userData=E.userData,this.prepareBreakableObject(j,G,E.userData.ammoPhysicsData.velocity,E.userData.ammoPhysicsData.angularVelocity,2*Q>this.minSizeForBreak),Z++}catch(U){ee("Error in ConvexObjectBreaker.ts",!0),ee(U,!0)}return v.object1=K,v.object2=j,Z}};q.transformFreeVector=function(E,x){var v=E.x,M=E.y,h=E.z,e=x.elements;return E.x=e[0]*v+e[4]*M+e[8]*h,E.y=e[1]*v+e[5]*M+e[9]*h,E.z=e[2]*v+e[6]*M+e[10]*h,E};q.transformFreeVectorInverse=function(E,x){var v=E.x,M=E.y,h=E.z,e=x.elements;return E.x=e[0]*v+e[1]*M+e[2]*h,E.y=e[4]*v+e[5]*M+e[6]*h,E.z=e[8]*v+e[9]*M+e[10]*h,E};q.transformTiedVectorInverse=function(E,x){var v=E.x,M=E.y,h=E.z,e=x.elements;return E.x=e[0]*v+e[1]*M+e[2]*h-e[12],E.y=e[4]*v+e[5]*M+e[6]*h-e[13],E.z=e[8]*v+e[9]*M+e[10]*h-e[14],E};q.transformPlaneToLocalSpace=function(){var E=new k;return function(v,M,h){h.normal.copy(v.normal),h.constant=v.constant;var e=q.transformTiedVectorInverse(v.coplanarPoint(E),M);q.transformFreeVectorInverse(h.normal,M),h.constant=-e.dot(h.normal)}}();const ft=(()=>{try{if(typeof WebAssembly=="object"&&typeof WebAssembly.instantiate=="function"){const E=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(E instanceof WebAssembly.Module)return new WebAssembly.Instance(E)instanceof WebAssembly.Instance}}catch(E){E instanceof Error&&console.error(E.message)}return!1})(),ze=(E,x)=>{var v=document.createElement("script");v.onload=()=>{x()},v.onerror=()=>{throw new Error(`failed to load ${E}`)},v.async=!0,v.src=E,document.head.appendChild(v)},At=(E,x)=>{ft?ze(`${E}/ammo.wasm.js`,()=>x()):ze(`${E}/ammo.js`,()=>x())};function Ge(E,x){x.forEach(v=>{Object.getOwnPropertyNames(v.prototype).forEach(M=>{Object.defineProperty(E.prototype,M,Object.getOwnPropertyDescriptor(v.prototype,M)||Object.create(null))})})}/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|LGPL-3.0}
 */class ct{constructor(x){this.physics=x}getHitPointWorld(){const x=this._btRayCallback.get_m_hitPointWorld();return{x:x.x(),y:x.y(),z:x.z()}}getHitNormalWorld(){const x=this._btRayCallback.get_m_hitNormalWorld();return{x:x.x(),y:x.y(),z:x.z()}}getCollisionObject(){return Ammo.castObject(this._btRayCallback.get_m_collisionObject(),Ammo.btRigidBody).threeObject}}/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|LGPL-3.0}
 */class ut{constructor(x){this.physics=x}getHitPointsWorld(){const x=this._btRayCallback.get_m_hitPointWorld(),v=[];for(let M=x.size()-1;M>=0;M--){const h=x.at(M);v.push({x:h.x(),y:h.y(),z:h.z()})}return v}getHitPointWorld(){return ee("Use getHitPointsWorld() instead of getHitPointWorld() for the AllHitsRayCaster!"),this.getHitPointsWorld()}getHitNormalsWorld(){const x=this._btRayCallback.get_m_hitNormalWorld(),v=[];for(let M=x.size()-1;M>=0;M--){const h=x.at(M);v.push({x:h.x(),y:h.y(),z:h.z()})}return v}getCollisionObjects(){const x=[],v=this._btRayCallback.get_m_collisionObjects();for(let M=v.size()-1;M>=0;M--){const h=Ammo.castObject(v.at(M),Ammo.btRigidBody);x.push(h.threeObject)}return x}}/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|LGPL-3.0}
 */class $e{constructor(x){this.physics=x}setRayFromWorld(x=0,v=0,M=0){this._btRayFrom.setValue(x,v,M)}setRayToWorld(x=0,v=0,M=0){this._btRayTo.setValue(x,v,M)}hasHit(){return this._btRayCallback.hasHit()}rayTest(){typeof this._btRayCallback<"u"&&Ammo.destroy(this._btRayCallback),this._btRayCallback=this.type==="closest"?new Ammo.ClosestRayResultCallback(this._btRayFrom,this._btRayTo):new Ammo.AllHitsRayResultCallback(this._btRayFrom,this._btRayTo),this.physics.physicsWorld.rayTest(this._btRayFrom,this._btRayTo,this._btRayCallback)}destroy(){typeof this._btRayFrom<"u"&&Ammo.destroy(this._btRayFrom),typeof this._btRayTo<"u"&&Ammo.destroy(this._btRayTo),typeof this._btRayCallback<"u"&&Ammo.destroy(this._btRayCallback)}}class ht{constructor(x){this.physics=x,this.type="closest",this._btRayFrom=new Ammo.btVector3(0,0,0),this._btRayTo=new Ammo.btVector3(0,0,0)}}class mt{constructor(x){this.physics=x,this.type="allHits",this._btRayFrom=new Ammo.btVector3(0,0,0),this._btRayTo=new Ammo.btVector3(0,0,0)}}Ge(ht,[$e,ct]);Ge(mt,[$e,ut]);const vt="0.25.4",pt=`Powered by enable3d v${vt}`;console.log(`%c %c %c %c %c ${pt} %c https://enable3d.io/`,"background: #ff0000","background: #ffff00","background: #00ff00","background: #00ffff","color: #fff; background: #000000;","background: none");/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|LGPL-3.0}
 */document.createElement("canvas");new qe;new Pe;new Pe;new Pe;var gt={exports:{}};/*!
 * matter-js 0.20.0 by @liabru
 * http://brm.io/matter-js/
 * License MIT
 * 
 * The MIT License (MIT)
 * 
 * Copyright (c) Liam Brummitt and contributors.
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(E,x){(function(M,h){E.exports=h()})(te,function(){return function(v){var M={};function h(e){if(M[e])return M[e].exports;var l=M[e]={i:e,l:!1,exports:{}};return v[e].call(l.exports,l,l.exports,h),l.l=!0,l.exports}return h.m=v,h.c=M,h.d=function(e,l,i){h.o(e,l)||Object.defineProperty(e,l,{enumerable:!0,get:i})},h.r=function(e){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},h.t=function(e,l){if(l&1&&(e=h(e)),l&8||l&4&&typeof e=="object"&&e&&e.__esModule)return e;var i=Object.create(null);if(h.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),l&2&&typeof e!="string")for(var a in e)h.d(i,a,(function(f){return e[f]}).bind(null,a));return i},h.n=function(e){var l=e&&e.__esModule?function(){return e.default}:function(){return e};return h.d(l,"a",l),l},h.o=function(e,l){return Object.prototype.hasOwnProperty.call(e,l)},h.p="",h(h.s=20)}([function(v,M){var h={};v.exports=h,function(){h._baseDelta=1e3/60,h._nextId=0,h._seed=0,h._nowStartTime=+new Date,h._warnedOnce={},h._decomp=null,h.extend=function(l,i){var a,f;typeof i=="boolean"?(a=2,f=i):(a=1,f=!0);for(var r=a;r<arguments.length;r++){var c=arguments[r];if(c)for(var o in c)f&&c[o]&&c[o].constructor===Object&&(!l[o]||l[o].constructor===Object)?(l[o]=l[o]||{},h.extend(l[o],f,c[o])):l[o]=c[o]}return l},h.clone=function(l,i){return h.extend({},i,l)},h.keys=function(l){if(Object.keys)return Object.keys(l);var i=[];for(var a in l)i.push(a);return i},h.values=function(l){var i=[];if(Object.keys){for(var a=Object.keys(l),f=0;f<a.length;f++)i.push(l[a[f]]);return i}for(var r in l)i.push(l[r]);return i},h.get=function(l,i,a,f){i=i.split(".").slice(a,f);for(var r=0;r<i.length;r+=1)l=l[i[r]];return l},h.set=function(l,i,a,f,r){var c=i.split(".").slice(f,r);return h.get(l,i,0,-1)[c[c.length-1]]=a,a},h.shuffle=function(l){for(var i=l.length-1;i>0;i--){var a=Math.floor(h.random()*(i+1)),f=l[i];l[i]=l[a],l[a]=f}return l},h.choose=function(l){return l[Math.floor(h.random()*l.length)]},h.isElement=function(l){return typeof HTMLElement<"u"?l instanceof HTMLElement:!!(l&&l.nodeType&&l.nodeName)},h.isArray=function(l){return Object.prototype.toString.call(l)==="[object Array]"},h.isFunction=function(l){return typeof l=="function"},h.isPlainObject=function(l){return typeof l=="object"&&l.constructor===Object},h.isString=function(l){return toString.call(l)==="[object String]"},h.clamp=function(l,i,a){return l<i?i:l>a?a:l},h.sign=function(l){return l<0?-1:1},h.now=function(){if(typeof window<"u"&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return Date.now?Date.now():new Date-h._nowStartTime},h.random=function(l,i){return l=typeof l<"u"?l:0,i=typeof i<"u"?i:1,l+e()*(i-l)};var e=function(){return h._seed=(h._seed*9301+49297)%233280,h._seed/233280};h.colorToNumber=function(l){return l=l.replace("#",""),l.length==3&&(l=l.charAt(0)+l.charAt(0)+l.charAt(1)+l.charAt(1)+l.charAt(2)+l.charAt(2)),parseInt(l,16)},h.logLevel=1,h.log=function(){console&&h.logLevel>0&&h.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},h.info=function(){console&&h.logLevel>0&&h.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},h.warn=function(){console&&h.logLevel>0&&h.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},h.warnOnce=function(){var l=Array.prototype.slice.call(arguments).join(" ");h._warnedOnce[l]||(h.warn(l),h._warnedOnce[l]=!0)},h.deprecated=function(l,i,a){l[i]=h.chain(function(){h.warnOnce("🔅 deprecated 🔅",a)},l[i])},h.nextId=function(){return h._nextId++},h.indexOf=function(l,i){if(l.indexOf)return l.indexOf(i);for(var a=0;a<l.length;a++)if(l[a]===i)return a;return-1},h.map=function(l,i){if(l.map)return l.map(i);for(var a=[],f=0;f<l.length;f+=1)a.push(i(l[f]));return a},h.topologicalSort=function(l){var i=[],a=[],f=[];for(var r in l)!a[r]&&!f[r]&&h._topologicalSort(r,a,f,l,i);return i},h._topologicalSort=function(l,i,a,f,r){var c=f[l]||[];a[l]=!0;for(var o=0;o<c.length;o+=1){var t=c[o];a[t]||i[t]||h._topologicalSort(t,i,a,f,r)}a[l]=!1,i[l]=!0,r.push(l)},h.chain=function(){for(var l=[],i=0;i<arguments.length;i+=1){var a=arguments[i];a._chained?l.push.apply(l,a._chained):l.push(a)}var f=function(){for(var r,c=new Array(arguments.length),o=0,t=arguments.length;o<t;o++)c[o]=arguments[o];for(o=0;o<l.length;o+=1){var n=l[o].apply(r,c);typeof n<"u"&&(r=n)}return r};return f._chained=l,f},h.chainPathBefore=function(l,i,a){return h.set(l,i,h.chain(a,h.get(l,i)))},h.chainPathAfter=function(l,i,a){return h.set(l,i,h.chain(h.get(l,i),a))},h.setDecomp=function(l){h._decomp=l},h.getDecomp=function(){var l=h._decomp;try{!l&&typeof window<"u"&&(l=window.decomp),!l&&typeof te<"u"&&(l=te.decomp)}catch{l=null}return l}}()},function(v,M){var h={};v.exports=h,function(){h.create=function(e){var l={min:{x:0,y:0},max:{x:0,y:0}};return e&&h.update(l,e),l},h.update=function(e,l,i){e.min.x=1/0,e.max.x=-1/0,e.min.y=1/0,e.max.y=-1/0;for(var a=0;a<l.length;a++){var f=l[a];f.x>e.max.x&&(e.max.x=f.x),f.x<e.min.x&&(e.min.x=f.x),f.y>e.max.y&&(e.max.y=f.y),f.y<e.min.y&&(e.min.y=f.y)}i&&(i.x>0?e.max.x+=i.x:e.min.x+=i.x,i.y>0?e.max.y+=i.y:e.min.y+=i.y)},h.contains=function(e,l){return l.x>=e.min.x&&l.x<=e.max.x&&l.y>=e.min.y&&l.y<=e.max.y},h.overlaps=function(e,l){return e.min.x<=l.max.x&&e.max.x>=l.min.x&&e.max.y>=l.min.y&&e.min.y<=l.max.y},h.translate=function(e,l){e.min.x+=l.x,e.max.x+=l.x,e.min.y+=l.y,e.max.y+=l.y},h.shift=function(e,l){var i=e.max.x-e.min.x,a=e.max.y-e.min.y;e.min.x=l.x,e.max.x=l.x+i,e.min.y=l.y,e.max.y=l.y+a}}()},function(v,M){var h={};v.exports=h,function(){h.create=function(e,l){return{x:e||0,y:l||0}},h.clone=function(e){return{x:e.x,y:e.y}},h.magnitude=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},h.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y},h.rotate=function(e,l,i){var a=Math.cos(l),f=Math.sin(l);i||(i={});var r=e.x*a-e.y*f;return i.y=e.x*f+e.y*a,i.x=r,i},h.rotateAbout=function(e,l,i,a){var f=Math.cos(l),r=Math.sin(l);a||(a={});var c=i.x+((e.x-i.x)*f-(e.y-i.y)*r);return a.y=i.y+((e.x-i.x)*r+(e.y-i.y)*f),a.x=c,a},h.normalise=function(e){var l=h.magnitude(e);return l===0?{x:0,y:0}:{x:e.x/l,y:e.y/l}},h.dot=function(e,l){return e.x*l.x+e.y*l.y},h.cross=function(e,l){return e.x*l.y-e.y*l.x},h.cross3=function(e,l,i){return(l.x-e.x)*(i.y-e.y)-(l.y-e.y)*(i.x-e.x)},h.add=function(e,l,i){return i||(i={}),i.x=e.x+l.x,i.y=e.y+l.y,i},h.sub=function(e,l,i){return i||(i={}),i.x=e.x-l.x,i.y=e.y-l.y,i},h.mult=function(e,l){return{x:e.x*l,y:e.y*l}},h.div=function(e,l){return{x:e.x/l,y:e.y/l}},h.perp=function(e,l){return l=l===!0?-1:1,{x:l*-e.y,y:l*e.x}},h.neg=function(e){return{x:-e.x,y:-e.y}},h.angle=function(e,l){return Math.atan2(l.y-e.y,l.x-e.x)},h._temp=[h.create(),h.create(),h.create(),h.create(),h.create(),h.create()]}()},function(v,M,h){var e={};v.exports=e;var l=h(2),i=h(0);(function(){e.create=function(a,f){for(var r=[],c=0;c<a.length;c++){var o=a[c],t={x:o.x,y:o.y,index:c,body:f,isInternal:!1};r.push(t)}return r},e.fromPath=function(a,f){var r=/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/ig,c=[];return a.replace(r,function(o,t,n){c.push({x:parseFloat(t),y:parseFloat(n)})}),e.create(c,f)},e.centre=function(a){for(var f=e.area(a,!0),r={x:0,y:0},c,o,t,n=0;n<a.length;n++)t=(n+1)%a.length,c=l.cross(a[n],a[t]),o=l.mult(l.add(a[n],a[t]),c),r=l.add(r,o);return l.div(r,6*f)},e.mean=function(a){for(var f={x:0,y:0},r=0;r<a.length;r++)f.x+=a[r].x,f.y+=a[r].y;return l.div(f,a.length)},e.area=function(a,f){for(var r=0,c=a.length-1,o=0;o<a.length;o++)r+=(a[c].x-a[o].x)*(a[c].y+a[o].y),c=o;return f?r/2:Math.abs(r)/2},e.inertia=function(a,f){for(var r=0,c=0,o=a,t,n,s=0;s<o.length;s++)n=(s+1)%o.length,t=Math.abs(l.cross(o[n],o[s])),r+=t*(l.dot(o[n],o[n])+l.dot(o[n],o[s])+l.dot(o[s],o[s])),c+=t;return f/6*(r/c)},e.translate=function(a,f,r){r=typeof r<"u"?r:1;var c=a.length,o=f.x*r,t=f.y*r,n;for(n=0;n<c;n++)a[n].x+=o,a[n].y+=t;return a},e.rotate=function(a,f,r){if(f!==0){var c=Math.cos(f),o=Math.sin(f),t=r.x,n=r.y,s=a.length,u,p,S,w;for(w=0;w<s;w++)u=a[w],p=u.x-t,S=u.y-n,u.x=t+(p*c-S*o),u.y=n+(p*o+S*c);return a}},e.contains=function(a,f){for(var r=f.x,c=f.y,o=a.length,t=a[o-1],n,s=0;s<o;s++){if(n=a[s],(r-t.x)*(n.y-t.y)+(c-t.y)*(t.x-n.x)>0)return!1;t=n}return!0},e.scale=function(a,f,r,c){if(f===1&&r===1)return a;c=c||e.centre(a);for(var o,t,n=0;n<a.length;n++)o=a[n],t=l.sub(o,c),a[n].x=c.x+t.x*f,a[n].y=c.y+t.y*r;return a},e.chamfer=function(a,f,r,c,o){typeof f=="number"?f=[f]:f=f||[8],r=typeof r<"u"?r:-1,c=c||2,o=o||14;for(var t=[],n=0;n<a.length;n++){var s=a[n-1>=0?n-1:a.length-1],u=a[n],p=a[(n+1)%a.length],S=f[n<f.length?n:f.length-1];if(S===0){t.push(u);continue}var w=l.normalise({x:u.y-s.y,y:s.x-u.x}),C=l.normalise({x:p.y-u.y,y:u.x-p.x}),m=Math.sqrt(2*Math.pow(S,2)),g=l.mult(i.clone(w),S),y=l.normalise(l.mult(l.add(w,C),.5)),d=l.sub(u,l.mult(y,m)),A=r;r===-1&&(A=Math.pow(S,.32)*1.75),A=i.clamp(A,c,o),A%2===1&&(A+=1);for(var P=Math.acos(l.dot(w,C)),T=P/A,V=0;V<A;V++)t.push(l.add(l.rotate(g,T*V),d))}return t},e.clockwiseSort=function(a){var f=e.mean(a);return a.sort(function(r,c){return l.angle(f,r)-l.angle(f,c)}),a},e.isConvex=function(a){var f=0,r=a.length,c,o,t,n;if(r<3)return null;for(c=0;c<r;c++)if(o=(c+1)%r,t=(c+2)%r,n=(a[o].x-a[c].x)*(a[t].y-a[o].y),n-=(a[o].y-a[c].y)*(a[t].x-a[o].x),n<0?f|=1:n>0&&(f|=2),f===3)return!1;return f!==0?!0:null},e.hull=function(a){var f=[],r=[],c,o;for(a=a.slice(0),a.sort(function(t,n){var s=t.x-n.x;return s!==0?s:t.y-n.y}),o=0;o<a.length;o+=1){for(c=a[o];r.length>=2&&l.cross3(r[r.length-2],r[r.length-1],c)<=0;)r.pop();r.push(c)}for(o=a.length-1;o>=0;o-=1){for(c=a[o];f.length>=2&&l.cross3(f[f.length-2],f[f.length-1],c)<=0;)f.pop();f.push(c)}return f.pop(),r.pop(),f.concat(r)}})()},function(v,M,h){var e={};v.exports=e;var l=h(3),i=h(2),a=h(7),f=h(0),r=h(1),c=h(11);(function(){e._timeCorrection=!0,e._inertiaScale=4,e._nextCollidingGroupId=1,e._nextNonCollidingGroupId=-1,e._nextCategory=1,e._baseDelta=1e3/60,e.create=function(t){var n={id:f.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:l.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,strokeStyle:null,fillStyle:null,lineWidth:null,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0}},events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inertia:0,deltaTime:16.666666666666668,_original:null},s=f.extend(n,t);return o(s,t),s},e.nextGroup=function(t){return t?e._nextNonCollidingGroupId--:e._nextCollidingGroupId++},e.nextCategory=function(){return e._nextCategory=e._nextCategory<<1,e._nextCategory};var o=function(t,n){n=n||{},e.set(t,{bounds:t.bounds||r.create(t.vertices),positionPrev:t.positionPrev||i.clone(t.position),anglePrev:t.anglePrev||t.angle,vertices:t.vertices,parts:t.parts||[t],isStatic:t.isStatic,isSleeping:t.isSleeping,parent:t.parent||t}),l.rotate(t.vertices,t.angle,t.position),c.rotate(t.axes,t.angle),r.update(t.bounds,t.vertices,t.velocity),e.set(t,{axes:n.axes||t.axes,area:n.area||t.area,mass:n.mass||t.mass,inertia:n.inertia||t.inertia});var s=t.isStatic?"#14151f":f.choose(["#f19648","#f5d259","#f55a3c","#063e7b","#ececd1"]),u=t.isStatic?"#555":"#ccc",p=t.isStatic&&t.render.fillStyle===null?1:0;t.render.fillStyle=t.render.fillStyle||s,t.render.strokeStyle=t.render.strokeStyle||u,t.render.lineWidth=t.render.lineWidth||p,t.render.sprite.xOffset+=-(t.bounds.min.x-t.position.x)/(t.bounds.max.x-t.bounds.min.x),t.render.sprite.yOffset+=-(t.bounds.min.y-t.position.y)/(t.bounds.max.y-t.bounds.min.y)};e.set=function(t,n,s){var u;typeof n=="string"&&(u=n,n={},n[u]=s);for(u in n)if(Object.prototype.hasOwnProperty.call(n,u))switch(s=n[u],u){case"isStatic":e.setStatic(t,s);break;case"isSleeping":a.set(t,s);break;case"mass":e.setMass(t,s);break;case"density":e.setDensity(t,s);break;case"inertia":e.setInertia(t,s);break;case"vertices":e.setVertices(t,s);break;case"position":e.setPosition(t,s);break;case"angle":e.setAngle(t,s);break;case"velocity":e.setVelocity(t,s);break;case"angularVelocity":e.setAngularVelocity(t,s);break;case"speed":e.setSpeed(t,s);break;case"angularSpeed":e.setAngularSpeed(t,s);break;case"parts":e.setParts(t,s);break;case"centre":e.setCentre(t,s);break;default:t[u]=s}},e.setStatic=function(t,n){for(var s=0;s<t.parts.length;s++){var u=t.parts[s];n?(u.isStatic||(u._original={restitution:u.restitution,friction:u.friction,mass:u.mass,inertia:u.inertia,density:u.density,inverseMass:u.inverseMass,inverseInertia:u.inverseInertia}),u.restitution=0,u.friction=1,u.mass=u.inertia=u.density=1/0,u.inverseMass=u.inverseInertia=0,u.positionPrev.x=u.position.x,u.positionPrev.y=u.position.y,u.anglePrev=u.angle,u.angularVelocity=0,u.speed=0,u.angularSpeed=0,u.motion=0):u._original&&(u.restitution=u._original.restitution,u.friction=u._original.friction,u.mass=u._original.mass,u.inertia=u._original.inertia,u.density=u._original.density,u.inverseMass=u._original.inverseMass,u.inverseInertia=u._original.inverseInertia,u._original=null),u.isStatic=n}},e.setMass=function(t,n){var s=t.inertia/(t.mass/6);t.inertia=s*(n/6),t.inverseInertia=1/t.inertia,t.mass=n,t.inverseMass=1/t.mass,t.density=t.mass/t.area},e.setDensity=function(t,n){e.setMass(t,n*t.area),t.density=n},e.setInertia=function(t,n){t.inertia=n,t.inverseInertia=1/t.inertia},e.setVertices=function(t,n){n[0].body===t?t.vertices=n:t.vertices=l.create(n,t),t.axes=c.fromVertices(t.vertices),t.area=l.area(t.vertices),e.setMass(t,t.density*t.area);var s=l.centre(t.vertices);l.translate(t.vertices,s,-1),e.setInertia(t,e._inertiaScale*l.inertia(t.vertices,t.mass)),l.translate(t.vertices,t.position),r.update(t.bounds,t.vertices,t.velocity)},e.setParts=function(t,n,s){var u;for(n=n.slice(0),t.parts.length=0,t.parts.push(t),t.parent=t,u=0;u<n.length;u++){var p=n[u];p!==t&&(p.parent=t,t.parts.push(p))}if(t.parts.length!==1){if(s=typeof s<"u"?s:!0,s){var S=[];for(u=0;u<n.length;u++)S=S.concat(n[u].vertices);l.clockwiseSort(S);var w=l.hull(S),C=l.centre(w);e.setVertices(t,w),l.translate(t.vertices,C)}var m=e._totalProperties(t);t.area=m.area,t.parent=t,t.position.x=m.centre.x,t.position.y=m.centre.y,t.positionPrev.x=m.centre.x,t.positionPrev.y=m.centre.y,e.setMass(t,m.mass),e.setInertia(t,m.inertia),e.setPosition(t,m.centre)}},e.setCentre=function(t,n,s){s?(t.positionPrev.x+=n.x,t.positionPrev.y+=n.y,t.position.x+=n.x,t.position.y+=n.y):(t.positionPrev.x=n.x-(t.position.x-t.positionPrev.x),t.positionPrev.y=n.y-(t.position.y-t.positionPrev.y),t.position.x=n.x,t.position.y=n.y)},e.setPosition=function(t,n,s){var u=i.sub(n,t.position);s?(t.positionPrev.x=t.position.x,t.positionPrev.y=t.position.y,t.velocity.x=u.x,t.velocity.y=u.y,t.speed=i.magnitude(u)):(t.positionPrev.x+=u.x,t.positionPrev.y+=u.y);for(var p=0;p<t.parts.length;p++){var S=t.parts[p];S.position.x+=u.x,S.position.y+=u.y,l.translate(S.vertices,u),r.update(S.bounds,S.vertices,t.velocity)}},e.setAngle=function(t,n,s){var u=n-t.angle;s?(t.anglePrev=t.angle,t.angularVelocity=u,t.angularSpeed=Math.abs(u)):t.anglePrev+=u;for(var p=0;p<t.parts.length;p++){var S=t.parts[p];S.angle+=u,l.rotate(S.vertices,u,t.position),c.rotate(S.axes,u),r.update(S.bounds,S.vertices,t.velocity),p>0&&i.rotateAbout(S.position,u,t.position,S.position)}},e.setVelocity=function(t,n){var s=t.deltaTime/e._baseDelta;t.positionPrev.x=t.position.x-n.x*s,t.positionPrev.y=t.position.y-n.y*s,t.velocity.x=(t.position.x-t.positionPrev.x)/s,t.velocity.y=(t.position.y-t.positionPrev.y)/s,t.speed=i.magnitude(t.velocity)},e.getVelocity=function(t){var n=e._baseDelta/t.deltaTime;return{x:(t.position.x-t.positionPrev.x)*n,y:(t.position.y-t.positionPrev.y)*n}},e.getSpeed=function(t){return i.magnitude(e.getVelocity(t))},e.setSpeed=function(t,n){e.setVelocity(t,i.mult(i.normalise(e.getVelocity(t)),n))},e.setAngularVelocity=function(t,n){var s=t.deltaTime/e._baseDelta;t.anglePrev=t.angle-n*s,t.angularVelocity=(t.angle-t.anglePrev)/s,t.angularSpeed=Math.abs(t.angularVelocity)},e.getAngularVelocity=function(t){return(t.angle-t.anglePrev)*e._baseDelta/t.deltaTime},e.getAngularSpeed=function(t){return Math.abs(e.getAngularVelocity(t))},e.setAngularSpeed=function(t,n){e.setAngularVelocity(t,f.sign(e.getAngularVelocity(t))*n)},e.translate=function(t,n,s){e.setPosition(t,i.add(t.position,n),s)},e.rotate=function(t,n,s,u){if(!s)e.setAngle(t,t.angle+n,u);else{var p=Math.cos(n),S=Math.sin(n),w=t.position.x-s.x,C=t.position.y-s.y;e.setPosition(t,{x:s.x+(w*p-C*S),y:s.y+(w*S+C*p)},u),e.setAngle(t,t.angle+n,u)}},e.scale=function(t,n,s,u){var p=0,S=0;u=u||t.position;for(var w=0;w<t.parts.length;w++){var C=t.parts[w];l.scale(C.vertices,n,s,u),C.axes=c.fromVertices(C.vertices),C.area=l.area(C.vertices),e.setMass(C,t.density*C.area),l.translate(C.vertices,{x:-C.position.x,y:-C.position.y}),e.setInertia(C,e._inertiaScale*l.inertia(C.vertices,C.mass)),l.translate(C.vertices,{x:C.position.x,y:C.position.y}),w>0&&(p+=C.area,S+=C.inertia),C.position.x=u.x+(C.position.x-u.x)*n,C.position.y=u.y+(C.position.y-u.y)*s,r.update(C.bounds,C.vertices,t.velocity)}t.parts.length>1&&(t.area=p,t.isStatic||(e.setMass(t,t.density*p),e.setInertia(t,S))),t.circleRadius&&(n===s?t.circleRadius*=n:t.circleRadius=null)},e.update=function(t,n){n=(typeof n<"u"?n:1e3/60)*t.timeScale;var s=n*n,u=e._timeCorrection?n/(t.deltaTime||n):1,p=1-t.frictionAir*(n/f._baseDelta),S=(t.position.x-t.positionPrev.x)*u,w=(t.position.y-t.positionPrev.y)*u;t.velocity.x=S*p+t.force.x/t.mass*s,t.velocity.y=w*p+t.force.y/t.mass*s,t.positionPrev.x=t.position.x,t.positionPrev.y=t.position.y,t.position.x+=t.velocity.x,t.position.y+=t.velocity.y,t.deltaTime=n,t.angularVelocity=(t.angle-t.anglePrev)*p*u+t.torque/t.inertia*s,t.anglePrev=t.angle,t.angle+=t.angularVelocity;for(var C=0;C<t.parts.length;C++){var m=t.parts[C];l.translate(m.vertices,t.velocity),C>0&&(m.position.x+=t.velocity.x,m.position.y+=t.velocity.y),t.angularVelocity!==0&&(l.rotate(m.vertices,t.angularVelocity,t.position),c.rotate(m.axes,t.angularVelocity),C>0&&i.rotateAbout(m.position,t.angularVelocity,t.position,m.position)),r.update(m.bounds,m.vertices,t.velocity)}},e.updateVelocities=function(t){var n=e._baseDelta/t.deltaTime,s=t.velocity;s.x=(t.position.x-t.positionPrev.x)*n,s.y=(t.position.y-t.positionPrev.y)*n,t.speed=Math.sqrt(s.x*s.x+s.y*s.y),t.angularVelocity=(t.angle-t.anglePrev)*n,t.angularSpeed=Math.abs(t.angularVelocity)},e.applyForce=function(t,n,s){var u={x:n.x-t.position.x,y:n.y-t.position.y};t.force.x+=s.x,t.force.y+=s.y,t.torque+=u.x*s.y-u.y*s.x},e._totalProperties=function(t){for(var n={mass:0,area:0,inertia:0,centre:{x:0,y:0}},s=t.parts.length===1?0:1;s<t.parts.length;s++){var u=t.parts[s],p=u.mass!==1/0?u.mass:1;n.mass+=p,n.area+=u.area,n.inertia+=u.inertia,n.centre=i.add(n.centre,i.mult(u.position,p))}return n.centre=i.div(n.centre,n.mass),n}})()},function(v,M,h){var e={};v.exports=e;var l=h(0);(function(){e.on=function(i,a,f){for(var r=a.split(" "),c,o=0;o<r.length;o++)c=r[o],i.events=i.events||{},i.events[c]=i.events[c]||[],i.events[c].push(f);return f},e.off=function(i,a,f){if(!a){i.events={};return}typeof a=="function"&&(f=a,a=l.keys(i.events).join(" "));for(var r=a.split(" "),c=0;c<r.length;c++){var o=i.events[r[c]],t=[];if(f&&o)for(var n=0;n<o.length;n++)o[n]!==f&&t.push(o[n]);i.events[r[c]]=t}},e.trigger=function(i,a,f){var r,c,o,t,n=i.events;if(n&&l.keys(n).length>0){f||(f={}),r=a.split(" ");for(var s=0;s<r.length;s++)if(c=r[s],o=n[c],o){t=l.clone(f,!1),t.name=c,t.source=i;for(var u=0;u<o.length;u++)o[u].apply(i,[t])}}}})()},function(v,M,h){var e={};v.exports=e;var l=h(5),i=h(0),a=h(1),f=h(4);(function(){e.create=function(r){return i.extend({id:i.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{},cache:{allBodies:null,allConstraints:null,allComposites:null}},r)},e.setModified=function(r,c,o,t){if(r.isModified=c,c&&r.cache&&(r.cache.allBodies=null,r.cache.allConstraints=null,r.cache.allComposites=null),o&&r.parent&&e.setModified(r.parent,c,o,t),t)for(var n=0;n<r.composites.length;n++){var s=r.composites[n];e.setModified(s,c,o,t)}},e.add=function(r,c){var o=[].concat(c);l.trigger(r,"beforeAdd",{object:c});for(var t=0;t<o.length;t++){var n=o[t];switch(n.type){case"body":if(n.parent!==n){i.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}e.addBody(r,n);break;case"constraint":e.addConstraint(r,n);break;case"composite":e.addComposite(r,n);break;case"mouseConstraint":e.addConstraint(r,n.constraint);break}}return l.trigger(r,"afterAdd",{object:c}),r},e.remove=function(r,c,o){var t=[].concat(c);l.trigger(r,"beforeRemove",{object:c});for(var n=0;n<t.length;n++){var s=t[n];switch(s.type){case"body":e.removeBody(r,s,o);break;case"constraint":e.removeConstraint(r,s,o);break;case"composite":e.removeComposite(r,s,o);break;case"mouseConstraint":e.removeConstraint(r,s.constraint);break}}return l.trigger(r,"afterRemove",{object:c}),r},e.addComposite=function(r,c){return r.composites.push(c),c.parent=r,e.setModified(r,!0,!0,!1),r},e.removeComposite=function(r,c,o){var t=i.indexOf(r.composites,c);if(t!==-1){var n=e.allBodies(c);e.removeCompositeAt(r,t);for(var s=0;s<n.length;s++)n[s].sleepCounter=0}if(o)for(var s=0;s<r.composites.length;s++)e.removeComposite(r.composites[s],c,!0);return r},e.removeCompositeAt=function(r,c){return r.composites.splice(c,1),e.setModified(r,!0,!0,!1),r},e.addBody=function(r,c){return r.bodies.push(c),e.setModified(r,!0,!0,!1),r},e.removeBody=function(r,c,o){var t=i.indexOf(r.bodies,c);if(t!==-1&&(e.removeBodyAt(r,t),c.sleepCounter=0),o)for(var n=0;n<r.composites.length;n++)e.removeBody(r.composites[n],c,!0);return r},e.removeBodyAt=function(r,c){return r.bodies.splice(c,1),e.setModified(r,!0,!0,!1),r},e.addConstraint=function(r,c){return r.constraints.push(c),e.setModified(r,!0,!0,!1),r},e.removeConstraint=function(r,c,o){var t=i.indexOf(r.constraints,c);if(t!==-1&&e.removeConstraintAt(r,t),o)for(var n=0;n<r.composites.length;n++)e.removeConstraint(r.composites[n],c,!0);return r},e.removeConstraintAt=function(r,c){return r.constraints.splice(c,1),e.setModified(r,!0,!0,!1),r},e.clear=function(r,c,o){if(o)for(var t=0;t<r.composites.length;t++)e.clear(r.composites[t],c,!0);return c?r.bodies=r.bodies.filter(function(n){return n.isStatic}):r.bodies.length=0,r.constraints.length=0,r.composites.length=0,e.setModified(r,!0,!0,!1),r},e.allBodies=function(r){if(r.cache&&r.cache.allBodies)return r.cache.allBodies;for(var c=[].concat(r.bodies),o=0;o<r.composites.length;o++)c=c.concat(e.allBodies(r.composites[o]));return r.cache&&(r.cache.allBodies=c),c},e.allConstraints=function(r){if(r.cache&&r.cache.allConstraints)return r.cache.allConstraints;for(var c=[].concat(r.constraints),o=0;o<r.composites.length;o++)c=c.concat(e.allConstraints(r.composites[o]));return r.cache&&(r.cache.allConstraints=c),c},e.allComposites=function(r){if(r.cache&&r.cache.allComposites)return r.cache.allComposites;for(var c=[].concat(r.composites),o=0;o<r.composites.length;o++)c=c.concat(e.allComposites(r.composites[o]));return r.cache&&(r.cache.allComposites=c),c},e.get=function(r,c,o){var t,n;switch(o){case"body":t=e.allBodies(r);break;case"constraint":t=e.allConstraints(r);break;case"composite":t=e.allComposites(r).concat(r);break}return t?(n=t.filter(function(s){return s.id.toString()===c.toString()}),n.length===0?null:n[0]):null},e.move=function(r,c,o){return e.remove(r,c),e.add(o,c),r},e.rebase=function(r){for(var c=e.allBodies(r).concat(e.allConstraints(r)).concat(e.allComposites(r)),o=0;o<c.length;o++)c[o].id=i.nextId();return r},e.translate=function(r,c,o){for(var t=o?e.allBodies(r):r.bodies,n=0;n<t.length;n++)f.translate(t[n],c);return r},e.rotate=function(r,c,o,t){for(var n=Math.cos(c),s=Math.sin(c),u=t?e.allBodies(r):r.bodies,p=0;p<u.length;p++){var S=u[p],w=S.position.x-o.x,C=S.position.y-o.y;f.setPosition(S,{x:o.x+(w*n-C*s),y:o.y+(w*s+C*n)}),f.rotate(S,c)}return r},e.scale=function(r,c,o,t,n){for(var s=n?e.allBodies(r):r.bodies,u=0;u<s.length;u++){var p=s[u],S=p.position.x-t.x,w=p.position.y-t.y;f.setPosition(p,{x:t.x+S*c,y:t.y+w*o}),f.scale(p,c,o)}return r},e.bounds=function(r){for(var c=e.allBodies(r),o=[],t=0;t<c.length;t+=1){var n=c[t];o.push(n.bounds.min,n.bounds.max)}return a.create(o)}})()},function(v,M,h){var e={};v.exports=e;var l=h(4),i=h(5),a=h(0);(function(){e._motionWakeThreshold=.18,e._motionSleepThreshold=.08,e._minBias=.9,e.update=function(f,r){for(var c=r/a._baseDelta,o=e._motionSleepThreshold,t=0;t<f.length;t++){var n=f[t],s=l.getSpeed(n),u=l.getAngularSpeed(n),p=s*s+u*u;if(n.force.x!==0||n.force.y!==0){e.set(n,!1);continue}var S=Math.min(n.motion,p),w=Math.max(n.motion,p);n.motion=e._minBias*S+(1-e._minBias)*w,n.sleepThreshold>0&&n.motion<o?(n.sleepCounter+=1,n.sleepCounter>=n.sleepThreshold/c&&e.set(n,!0)):n.sleepCounter>0&&(n.sleepCounter-=1)}},e.afterCollisions=function(f){for(var r=e._motionSleepThreshold,c=0;c<f.length;c++){var o=f[c];if(o.isActive){var t=o.collision,n=t.bodyA.parent,s=t.bodyB.parent;if(!(n.isSleeping&&s.isSleeping||n.isStatic||s.isStatic)&&(n.isSleeping||s.isSleeping)){var u=n.isSleeping&&!n.isStatic?n:s,p=u===n?s:n;!u.isStatic&&p.motion>r&&e.set(u,!1)}}}},e.set=function(f,r){var c=f.isSleeping;r?(f.isSleeping=!0,f.sleepCounter=f.sleepThreshold,f.positionImpulse.x=0,f.positionImpulse.y=0,f.positionPrev.x=f.position.x,f.positionPrev.y=f.position.y,f.anglePrev=f.angle,f.speed=0,f.angularSpeed=0,f.motion=0,c||i.trigger(f,"sleepStart")):(f.isSleeping=!1,f.sleepCounter=0,c&&i.trigger(f,"sleepEnd"))}})()},function(v,M,h){var e={};v.exports=e;var l=h(3),i=h(9);(function(){var a=[],f={overlap:0,axis:null},r={overlap:0,axis:null};e.create=function(c,o){return{pair:null,collided:!1,bodyA:c,bodyB:o,parentA:c.parent,parentB:o.parent,depth:0,normal:{x:0,y:0},tangent:{x:0,y:0},penetration:{x:0,y:0},supports:[null,null],supportCount:0}},e.collides=function(c,o,t){if(e._overlapAxes(f,c.vertices,o.vertices,c.axes),f.overlap<=0||(e._overlapAxes(r,o.vertices,c.vertices,o.axes),r.overlap<=0))return null;var n=t&&t.table[i.id(c,o)],s;n?s=n.collision:(s=e.create(c,o),s.collided=!0,s.bodyA=c.id<o.id?c:o,s.bodyB=c.id<o.id?o:c,s.parentA=s.bodyA.parent,s.parentB=s.bodyB.parent),c=s.bodyA,o=s.bodyB;var u;f.overlap<r.overlap?u=f:u=r;var p=s.normal,S=s.tangent,w=s.penetration,C=s.supports,m=u.overlap,g=u.axis,y=g.x,d=g.y,A=o.position.x-c.position.x,P=o.position.y-c.position.y;y*A+d*P>=0&&(y=-y,d=-d),p.x=y,p.y=d,S.x=-d,S.y=y,w.x=y*m,w.y=d*m,s.depth=m;var T=e._findSupports(c,o,p,1),V=0;if(l.contains(c.vertices,T[0])&&(C[V++]=T[0]),l.contains(c.vertices,T[1])&&(C[V++]=T[1]),V<2){var I=e._findSupports(o,c,p,-1);l.contains(o.vertices,I[0])&&(C[V++]=I[0]),V<2&&l.contains(o.vertices,I[1])&&(C[V++]=I[1])}return V===0&&(C[V++]=T[0]),s.supportCount=V,s},e._overlapAxes=function(c,o,t,n){var s=o.length,u=t.length,p=o[0].x,S=o[0].y,w=t[0].x,C=t[0].y,m=n.length,g=Number.MAX_VALUE,y=0,d,A,P,T,V,I;for(V=0;V<m;V++){var R=n[V],B=R.x,D=R.y,F=p*B+S*D,L=w*B+C*D,O=F,b=L;for(I=1;I<s;I+=1)T=o[I].x*B+o[I].y*D,T>O?O=T:T<F&&(F=T);for(I=1;I<u;I+=1)T=t[I].x*B+t[I].y*D,T>b?b=T:T<L&&(L=T);if(A=O-L,P=b-F,d=A<P?A:P,d<g&&(g=d,y=V,d<=0))break}c.axis=n[y],c.overlap=g},e._findSupports=function(c,o,t,n){var s=o.vertices,u=s.length,p=c.position.x,S=c.position.y,w=t.x*n,C=t.y*n,m=s[0],g=m,y=w*(p-g.x)+C*(S-g.y),d,A,P;for(P=1;P<u;P+=1)g=s[P],A=w*(p-g.x)+C*(S-g.y),A<y&&(y=A,m=g);return d=s[(u+m.index-1)%u],y=w*(p-d.x)+C*(S-d.y),g=s[(m.index+1)%u],w*(p-g.x)+C*(S-g.y)<y?(a[0]=m,a[1]=g,a):(a[0]=m,a[1]=d,a)}})()},function(v,M,h){var e={};v.exports=e;var l=h(16);(function(){e.create=function(i,a){var f=i.bodyA,r=i.bodyB,c={id:e.id(f,r),bodyA:f,bodyB:r,collision:i,contacts:[l.create(),l.create()],contactCount:0,separation:0,isActive:!0,isSensor:f.isSensor||r.isSensor,timeCreated:a,timeUpdated:a,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};return e.update(c,i,a),c},e.update=function(i,a,f){var r=a.supports,c=a.supportCount,o=i.contacts,t=a.parentA,n=a.parentB;i.isActive=!0,i.timeUpdated=f,i.collision=a,i.separation=a.depth,i.inverseMass=t.inverseMass+n.inverseMass,i.friction=t.friction<n.friction?t.friction:n.friction,i.frictionStatic=t.frictionStatic>n.frictionStatic?t.frictionStatic:n.frictionStatic,i.restitution=t.restitution>n.restitution?t.restitution:n.restitution,i.slop=t.slop>n.slop?t.slop:n.slop,i.contactCount=c,a.pair=i;var s=r[0],u=o[0],p=r[1],S=o[1];(S.vertex===s||u.vertex===p)&&(o[1]=u,o[0]=u=S,S=o[1]),u.vertex=s,S.vertex=p},e.setActive=function(i,a,f){a?(i.isActive=!0,i.timeUpdated=f):(i.isActive=!1,i.contactCount=0)},e.id=function(i,a){return i.id<a.id?i.id.toString(36)+":"+a.id.toString(36):a.id.toString(36)+":"+i.id.toString(36)}})()},function(v,M,h){var e={};v.exports=e;var l=h(3),i=h(2),a=h(7),f=h(1),r=h(11),c=h(0);(function(){e._warming=.4,e._torqueDampen=1,e._minLength=1e-6,e.create=function(o){var t=o;t.bodyA&&!t.pointA&&(t.pointA={x:0,y:0}),t.bodyB&&!t.pointB&&(t.pointB={x:0,y:0});var n=t.bodyA?i.add(t.bodyA.position,t.pointA):t.pointA,s=t.bodyB?i.add(t.bodyB.position,t.pointB):t.pointB,u=i.magnitude(i.sub(n,s));t.length=typeof t.length<"u"?t.length:u,t.id=t.id||c.nextId(),t.label=t.label||"Constraint",t.type="constraint",t.stiffness=t.stiffness||(t.length>0?1:.7),t.damping=t.damping||0,t.angularStiffness=t.angularStiffness||0,t.angleA=t.bodyA?t.bodyA.angle:t.angleA,t.angleB=t.bodyB?t.bodyB.angle:t.angleB,t.plugin={};var p={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return t.length===0&&t.stiffness>.1?(p.type="pin",p.anchors=!1):t.stiffness<.9&&(p.type="spring"),t.render=c.extend(p,t.render),t},e.preSolveAll=function(o){for(var t=0;t<o.length;t+=1){var n=o[t],s=n.constraintImpulse;n.isStatic||s.x===0&&s.y===0&&s.angle===0||(n.position.x+=s.x,n.position.y+=s.y,n.angle+=s.angle)}},e.solveAll=function(o,t){for(var n=c.clamp(t/c._baseDelta,0,1),s=0;s<o.length;s+=1){var u=o[s],p=!u.bodyA||u.bodyA&&u.bodyA.isStatic,S=!u.bodyB||u.bodyB&&u.bodyB.isStatic;(p||S)&&e.solve(o[s],n)}for(s=0;s<o.length;s+=1)u=o[s],p=!u.bodyA||u.bodyA&&u.bodyA.isStatic,S=!u.bodyB||u.bodyB&&u.bodyB.isStatic,!p&&!S&&e.solve(o[s],n)},e.solve=function(o,t){var n=o.bodyA,s=o.bodyB,u=o.pointA,p=o.pointB;if(!(!n&&!s)){n&&!n.isStatic&&(i.rotate(u,n.angle-o.angleA,u),o.angleA=n.angle),s&&!s.isStatic&&(i.rotate(p,s.angle-o.angleB,p),o.angleB=s.angle);var S=u,w=p;if(n&&(S=i.add(n.position,u)),s&&(w=i.add(s.position,p)),!(!S||!w)){var C=i.sub(S,w),m=i.magnitude(C);m<e._minLength&&(m=e._minLength);var g=(m-o.length)/m,y=o.stiffness>=1||o.length===0,d=y?o.stiffness*t:o.stiffness*t*t,A=o.damping*t,P=i.mult(C,g*d),T=(n?n.inverseMass:0)+(s?s.inverseMass:0),V=(n?n.inverseInertia:0)+(s?s.inverseInertia:0),I=T+V,R,B,D,F,L;if(A>0){var O=i.create();D=i.div(C,m),L=i.sub(s&&i.sub(s.position,s.positionPrev)||O,n&&i.sub(n.position,n.positionPrev)||O),F=i.dot(D,L)}n&&!n.isStatic&&(B=n.inverseMass/T,n.constraintImpulse.x-=P.x*B,n.constraintImpulse.y-=P.y*B,n.position.x-=P.x*B,n.position.y-=P.y*B,A>0&&(n.positionPrev.x-=A*D.x*F*B,n.positionPrev.y-=A*D.y*F*B),R=i.cross(u,P)/I*e._torqueDampen*n.inverseInertia*(1-o.angularStiffness),n.constraintImpulse.angle-=R,n.angle-=R),s&&!s.isStatic&&(B=s.inverseMass/T,s.constraintImpulse.x+=P.x*B,s.constraintImpulse.y+=P.y*B,s.position.x+=P.x*B,s.position.y+=P.y*B,A>0&&(s.positionPrev.x+=A*D.x*F*B,s.positionPrev.y+=A*D.y*F*B),R=i.cross(p,P)/I*e._torqueDampen*s.inverseInertia*(1-o.angularStiffness),s.constraintImpulse.angle+=R,s.angle+=R)}}},e.postSolveAll=function(o){for(var t=0;t<o.length;t++){var n=o[t],s=n.constraintImpulse;if(!(n.isStatic||s.x===0&&s.y===0&&s.angle===0)){a.set(n,!1);for(var u=0;u<n.parts.length;u++){var p=n.parts[u];l.translate(p.vertices,s),u>0&&(p.position.x+=s.x,p.position.y+=s.y),s.angle!==0&&(l.rotate(p.vertices,s.angle,n.position),r.rotate(p.axes,s.angle),u>0&&i.rotateAbout(p.position,s.angle,n.position,p.position)),f.update(p.bounds,p.vertices,n.velocity)}s.angle*=e._warming,s.x*=e._warming,s.y*=e._warming}}},e.pointAWorld=function(o){return{x:(o.bodyA?o.bodyA.position.x:0)+(o.pointA?o.pointA.x:0),y:(o.bodyA?o.bodyA.position.y:0)+(o.pointA?o.pointA.y:0)}},e.pointBWorld=function(o){return{x:(o.bodyB?o.bodyB.position.x:0)+(o.pointB?o.pointB.x:0),y:(o.bodyB?o.bodyB.position.y:0)+(o.pointB?o.pointB.y:0)}},e.currentLength=function(o){var t=(o.bodyA?o.bodyA.position.x:0)+(o.pointA?o.pointA.x:0),n=(o.bodyA?o.bodyA.position.y:0)+(o.pointA?o.pointA.y:0),s=(o.bodyB?o.bodyB.position.x:0)+(o.pointB?o.pointB.x:0),u=(o.bodyB?o.bodyB.position.y:0)+(o.pointB?o.pointB.y:0),p=t-s,S=n-u;return Math.sqrt(p*p+S*S)}})()},function(v,M,h){var e={};v.exports=e;var l=h(2),i=h(0);(function(){e.fromVertices=function(a){for(var f={},r=0;r<a.length;r++){var c=(r+1)%a.length,o=l.normalise({x:a[c].y-a[r].y,y:a[r].x-a[c].x}),t=o.y===0?1/0:o.x/o.y;t=t.toFixed(3).toString(),f[t]=o}return i.values(f)},e.rotate=function(a,f){if(f!==0)for(var r=Math.cos(f),c=Math.sin(f),o=0;o<a.length;o++){var t=a[o],n;n=t.x*r-t.y*c,t.y=t.x*c+t.y*r,t.x=n}}})()},function(v,M,h){var e={};v.exports=e;var l=h(3),i=h(0),a=h(4),f=h(1),r=h(2);(function(){e.rectangle=function(c,o,t,n,s){s=s||{};var u={label:"Rectangle Body",position:{x:c,y:o},vertices:l.fromPath("L 0 0 L "+t+" 0 L "+t+" "+n+" L 0 "+n)};if(s.chamfer){var p=s.chamfer;u.vertices=l.chamfer(u.vertices,p.radius,p.quality,p.qualityMin,p.qualityMax),delete s.chamfer}return a.create(i.extend({},u,s))},e.trapezoid=function(c,o,t,n,s,u){u=u||{},s>=1&&i.warn("Bodies.trapezoid: slope parameter must be < 1."),s*=.5;var p=(1-s*2)*t,S=t*s,w=S+p,C=w+S,m;s<.5?m="L 0 0 L "+S+" "+-n+" L "+w+" "+-n+" L "+C+" 0":m="L 0 0 L "+w+" "+-n+" L "+C+" 0";var g={label:"Trapezoid Body",position:{x:c,y:o},vertices:l.fromPath(m)};if(u.chamfer){var y=u.chamfer;g.vertices=l.chamfer(g.vertices,y.radius,y.quality,y.qualityMin,y.qualityMax),delete u.chamfer}return a.create(i.extend({},g,u))},e.circle=function(c,o,t,n,s){n=n||{};var u={label:"Circle Body",circleRadius:t};s=s||25;var p=Math.ceil(Math.max(10,Math.min(s,t)));return p%2===1&&(p+=1),e.polygon(c,o,p,t,i.extend({},u,n))},e.polygon=function(c,o,t,n,s){if(s=s||{},t<3)return e.circle(c,o,n,s);for(var u=2*Math.PI/t,p="",S=u*.5,w=0;w<t;w+=1){var C=S+w*u,m=Math.cos(C)*n,g=Math.sin(C)*n;p+="L "+m.toFixed(3)+" "+g.toFixed(3)+" "}var y={label:"Polygon Body",position:{x:c,y:o},vertices:l.fromPath(p)};if(s.chamfer){var d=s.chamfer;y.vertices=l.chamfer(y.vertices,d.radius,d.quality,d.qualityMin,d.qualityMax),delete s.chamfer}return a.create(i.extend({},y,s))},e.fromVertices=function(c,o,t,n,s,u,p,S){var w=i.getDecomp(),C,m,g,y,d,A,P,T,V,I,R;for(C=!!(w&&w.quickDecomp),n=n||{},g=[],s=typeof s<"u"?s:!1,u=typeof u<"u"?u:.01,p=typeof p<"u"?p:10,S=typeof S<"u"?S:.01,i.isArray(t[0])||(t=[t]),I=0;I<t.length;I+=1)if(A=t[I],y=l.isConvex(A),d=!y,d&&!C&&i.warnOnce("Bodies.fromVertices: Install the 'poly-decomp' library and use Common.setDecomp or provide 'decomp' as a global to decompose concave vertices."),y||!C)y?A=l.clockwiseSort(A):A=l.hull(A),g.push({position:{x:c,y:o},vertices:A});else{var B=A.map(function(H){return[H.x,H.y]});w.makeCCW(B),u!==!1&&w.removeCollinearPoints(B,u),S!==!1&&w.removeDuplicatePoints&&w.removeDuplicatePoints(B,S);var D=w.quickDecomp(B);for(P=0;P<D.length;P++){var F=D[P],L=F.map(function(H){return{x:H[0],y:H[1]}});p>0&&l.area(L)<p||g.push({position:l.centre(L),vertices:L})}}for(P=0;P<g.length;P++)g[P]=a.create(i.extend(g[P],n));if(s){var O=5;for(P=0;P<g.length;P++){var b=g[P];for(T=P+1;T<g.length;T++){var W=g[T];if(f.overlaps(b.bounds,W.bounds)){var z=b.vertices,G=W.vertices;for(V=0;V<b.vertices.length;V++)for(R=0;R<W.vertices.length;R++){var X=r.magnitudeSquared(r.sub(z[(V+1)%z.length],G[R])),$=r.magnitudeSquared(r.sub(z[V],G[(R+1)%G.length]));X<O&&$<O&&(z[V].isInternal=!0,G[R].isInternal=!0)}}}}}return g.length>1?(m=a.create(i.extend({parts:g.slice(0)},n)),a.setPosition(m,{x:c,y:o}),m):g[0]}})()},function(v,M,h){var e={};v.exports=e;var l=h(0),i=h(8);(function(){e.create=function(a){var f={bodies:[],collisions:[],pairs:null};return l.extend(f,a)},e.setBodies=function(a,f){a.bodies=f.slice(0)},e.clear=function(a){a.bodies=[],a.collisions=[]},e.collisions=function(a){var f=a.pairs,r=a.bodies,c=r.length,o=e.canCollide,t=i.collides,n=a.collisions,s=0,u,p;for(r.sort(e._compareBoundsX),u=0;u<c;u++){var S=r[u],w=S.bounds,C=S.bounds.max.x,m=S.bounds.max.y,g=S.bounds.min.y,y=S.isStatic||S.isSleeping,d=S.parts.length,A=d===1;for(p=u+1;p<c;p++){var P=r[p],T=P.bounds;if(T.min.x>C)break;if(!(m<T.min.y||g>T.max.y)&&!(y&&(P.isStatic||P.isSleeping))&&o(S.collisionFilter,P.collisionFilter)){var V=P.parts.length;if(A&&V===1){var I=t(S,P,f);I&&(n[s++]=I)}else for(var R=d>1?1:0,B=V>1?1:0,D=R;D<d;D++)for(var F=S.parts[D],w=F.bounds,L=B;L<V;L++){var O=P.parts[L],T=O.bounds;if(!(w.min.x>T.max.x||w.max.x<T.min.x||w.max.y<T.min.y||w.min.y>T.max.y)){var I=t(F,O,f);I&&(n[s++]=I)}}}}}return n.length!==s&&(n.length=s),n},e.canCollide=function(a,f){return a.group===f.group&&a.group!==0?a.group>0:(a.mask&f.category)!==0&&(f.mask&a.category)!==0},e._compareBoundsX=function(a,f){return a.bounds.min.x-f.bounds.min.x}})()},function(v,M,h){var e={};v.exports=e;var l=h(0);(function(){e.create=function(i){var a={};return i||l.log("Mouse.create: element was undefined, defaulting to document.body","warn"),a.element=i||document.body,a.absolute={x:0,y:0},a.position={x:0,y:0},a.mousedownPosition={x:0,y:0},a.mouseupPosition={x:0,y:0},a.offset={x:0,y:0},a.scale={x:1,y:1},a.wheelDelta=0,a.button=-1,a.pixelRatio=parseInt(a.element.getAttribute("data-pixel-ratio"),10)||1,a.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},a.mousemove=function(f){var r=e._getRelativeMousePosition(f,a.element,a.pixelRatio),c=f.changedTouches;c&&(a.button=0,f.preventDefault()),a.absolute.x=r.x,a.absolute.y=r.y,a.position.x=a.absolute.x*a.scale.x+a.offset.x,a.position.y=a.absolute.y*a.scale.y+a.offset.y,a.sourceEvents.mousemove=f},a.mousedown=function(f){var r=e._getRelativeMousePosition(f,a.element,a.pixelRatio),c=f.changedTouches;c?(a.button=0,f.preventDefault()):a.button=f.button,a.absolute.x=r.x,a.absolute.y=r.y,a.position.x=a.absolute.x*a.scale.x+a.offset.x,a.position.y=a.absolute.y*a.scale.y+a.offset.y,a.mousedownPosition.x=a.position.x,a.mousedownPosition.y=a.position.y,a.sourceEvents.mousedown=f},a.mouseup=function(f){var r=e._getRelativeMousePosition(f,a.element,a.pixelRatio),c=f.changedTouches;c&&f.preventDefault(),a.button=-1,a.absolute.x=r.x,a.absolute.y=r.y,a.position.x=a.absolute.x*a.scale.x+a.offset.x,a.position.y=a.absolute.y*a.scale.y+a.offset.y,a.mouseupPosition.x=a.position.x,a.mouseupPosition.y=a.position.y,a.sourceEvents.mouseup=f},a.mousewheel=function(f){a.wheelDelta=Math.max(-1,Math.min(1,f.wheelDelta||-f.detail)),f.preventDefault(),a.sourceEvents.mousewheel=f},e.setElement(a,a.element),a},e.setElement=function(i,a){i.element=a,a.addEventListener("mousemove",i.mousemove,{passive:!0}),a.addEventListener("mousedown",i.mousedown,{passive:!0}),a.addEventListener("mouseup",i.mouseup,{passive:!0}),a.addEventListener("wheel",i.mousewheel,{passive:!1}),a.addEventListener("touchmove",i.mousemove,{passive:!1}),a.addEventListener("touchstart",i.mousedown,{passive:!1}),a.addEventListener("touchend",i.mouseup,{passive:!1})},e.clearSourceEvents=function(i){i.sourceEvents.mousemove=null,i.sourceEvents.mousedown=null,i.sourceEvents.mouseup=null,i.sourceEvents.mousewheel=null,i.wheelDelta=0},e.setOffset=function(i,a){i.offset.x=a.x,i.offset.y=a.y,i.position.x=i.absolute.x*i.scale.x+i.offset.x,i.position.y=i.absolute.y*i.scale.y+i.offset.y},e.setScale=function(i,a){i.scale.x=a.x,i.scale.y=a.y,i.position.x=i.absolute.x*i.scale.x+i.offset.x,i.position.y=i.absolute.y*i.scale.y+i.offset.y},e._getRelativeMousePosition=function(i,a,f){var r=a.getBoundingClientRect(),c=document.documentElement||document.body.parentNode||document.body,o=window.pageXOffset!==void 0?window.pageXOffset:c.scrollLeft,t=window.pageYOffset!==void 0?window.pageYOffset:c.scrollTop,n=i.changedTouches,s,u;return n?(s=n[0].pageX-r.left-o,u=n[0].pageY-r.top-t):(s=i.pageX-r.left-o,u=i.pageY-r.top-t),{x:s/(a.clientWidth/(a.width||a.clientWidth)*f),y:u/(a.clientHeight/(a.height||a.clientHeight)*f)}}})()},function(v,M,h){var e={};v.exports=e;var l=h(0);(function(){e._registry={},e.register=function(i){if(e.isPlugin(i)||l.warn("Plugin.register:",e.toString(i),"does not implement all required fields."),i.name in e._registry){var a=e._registry[i.name],f=e.versionParse(i.version).number,r=e.versionParse(a.version).number;f>r?(l.warn("Plugin.register:",e.toString(a),"was upgraded to",e.toString(i)),e._registry[i.name]=i):f<r?l.warn("Plugin.register:",e.toString(a),"can not be downgraded to",e.toString(i)):i!==a&&l.warn("Plugin.register:",e.toString(i),"is already registered to different plugin object")}else e._registry[i.name]=i;return i},e.resolve=function(i){return e._registry[e.dependencyParse(i).name]},e.toString=function(i){return typeof i=="string"?i:(i.name||"anonymous")+"@"+(i.version||i.range||"0.0.0")},e.isPlugin=function(i){return i&&i.name&&i.version&&i.install},e.isUsed=function(i,a){return i.used.indexOf(a)>-1},e.isFor=function(i,a){var f=i.for&&e.dependencyParse(i.for);return!i.for||a.name===f.name&&e.versionSatisfies(a.version,f.range)},e.use=function(i,a){if(i.uses=(i.uses||[]).concat(a||[]),i.uses.length===0){l.warn("Plugin.use:",e.toString(i),"does not specify any dependencies to install.");return}for(var f=e.dependencies(i),r=l.topologicalSort(f),c=[],o=0;o<r.length;o+=1)if(r[o]!==i.name){var t=e.resolve(r[o]);if(!t){c.push("❌ "+r[o]);continue}e.isUsed(i,t.name)||(e.isFor(t,i)||(l.warn("Plugin.use:",e.toString(t),"is for",t.for,"but installed on",e.toString(i)+"."),t._warned=!0),t.install?t.install(i):(l.warn("Plugin.use:",e.toString(t),"does not specify an install function."),t._warned=!0),t._warned?(c.push("🔶 "+e.toString(t)),delete t._warned):c.push("✅ "+e.toString(t)),i.used.push(t.name))}c.length>0&&l.info(c.join("  "))},e.dependencies=function(i,a){var f=e.dependencyParse(i),r=f.name;if(a=a||{},!(r in a)){i=e.resolve(i)||i,a[r]=l.map(i.uses||[],function(o){e.isPlugin(o)&&e.register(o);var t=e.dependencyParse(o),n=e.resolve(o);return n&&!e.versionSatisfies(n.version,t.range)?(l.warn("Plugin.dependencies:",e.toString(n),"does not satisfy",e.toString(t),"used by",e.toString(f)+"."),n._warned=!0,i._warned=!0):n||(l.warn("Plugin.dependencies:",e.toString(o),"used by",e.toString(f),"could not be resolved."),i._warned=!0),t.name});for(var c=0;c<a[r].length;c+=1)e.dependencies(a[r][c],a);return a}},e.dependencyParse=function(i){if(l.isString(i)){var a=/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-+]+)?))?$/;return a.test(i)||l.warn("Plugin.dependencyParse:",i,"is not a valid dependency string."),{name:i.split("@")[0],range:i.split("@")[1]||"*"}}return{name:i.name,range:i.range||i.version}},e.versionParse=function(i){var a=/^(\*)|(\^|~|>=|>)?\s*((\d+)\.(\d+)\.(\d+))(-[0-9A-Za-z-+]+)?$/;a.test(i)||l.warn("Plugin.versionParse:",i,"is not a valid version or range.");var f=a.exec(i),r=Number(f[4]),c=Number(f[5]),o=Number(f[6]);return{isRange:!!(f[1]||f[2]),version:f[3],range:i,operator:f[1]||f[2]||"",major:r,minor:c,patch:o,parts:[r,c,o],prerelease:f[7],number:r*1e8+c*1e4+o}},e.versionSatisfies=function(i,a){a=a||"*";var f=e.versionParse(a),r=e.versionParse(i);if(f.isRange){if(f.operator==="*"||i==="*")return!0;if(f.operator===">")return r.number>f.number;if(f.operator===">=")return r.number>=f.number;if(f.operator==="~")return r.major===f.major&&r.minor===f.minor&&r.patch>=f.patch;if(f.operator==="^")return f.major>0?r.major===f.major&&r.number>=f.number:f.minor>0?r.minor===f.minor&&r.patch>=f.patch:r.patch===f.patch}return i===a||i==="*"}})()},function(v,M){var h={};v.exports=h,function(){h.create=function(e){return{vertex:e,normalImpulse:0,tangentImpulse:0}}}()},function(v,M,h){var e={};v.exports=e;var l=h(7),i=h(18),a=h(13),f=h(19),r=h(5),c=h(6),o=h(10),t=h(0),n=h(4);(function(){e._deltaMax=1e3/60,e.create=function(s){s=s||{};var u={positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},gravity:{x:0,y:1,scale:.001},timing:{timestamp:0,timeScale:1,lastDelta:0,lastElapsed:0,lastUpdatesPerFrame:0}},p=t.extend(u,s);return p.world=s.world||c.create({label:"World"}),p.pairs=s.pairs||f.create(),p.detector=s.detector||a.create(),p.detector.pairs=p.pairs,p.grid={buckets:[]},p.world.gravity=p.gravity,p.broadphase=p.grid,p.metrics={},p},e.update=function(s,u){var p=t.now(),S=s.world,w=s.detector,C=s.pairs,m=s.timing,g=m.timestamp,y;u>e._deltaMax&&t.warnOnce("Matter.Engine.update: delta argument is recommended to be less than or equal to",e._deltaMax.toFixed(3),"ms."),u=typeof u<"u"?u:t._baseDelta,u*=m.timeScale,m.timestamp+=u,m.lastDelta=u;var d={timestamp:m.timestamp,delta:u};r.trigger(s,"beforeUpdate",d);var A=c.allBodies(S),P=c.allConstraints(S);for(S.isModified&&(a.setBodies(w,A),c.setModified(S,!1,!1,!0)),s.enableSleeping&&l.update(A,u),e._bodiesApplyGravity(A,s.gravity),u>0&&e._bodiesUpdate(A,u),r.trigger(s,"beforeSolve",d),o.preSolveAll(A),y=0;y<s.constraintIterations;y++)o.solveAll(P,u);o.postSolveAll(A);var T=a.collisions(w);f.update(C,T,g),s.enableSleeping&&l.afterCollisions(C.list),C.collisionStart.length>0&&r.trigger(s,"collisionStart",{pairs:C.collisionStart,timestamp:m.timestamp,delta:u});var V=t.clamp(20/s.positionIterations,0,1);for(i.preSolvePosition(C.list),y=0;y<s.positionIterations;y++)i.solvePosition(C.list,u,V);for(i.postSolvePosition(A),o.preSolveAll(A),y=0;y<s.constraintIterations;y++)o.solveAll(P,u);for(o.postSolveAll(A),i.preSolveVelocity(C.list),y=0;y<s.velocityIterations;y++)i.solveVelocity(C.list,u);return e._bodiesUpdateVelocities(A),C.collisionActive.length>0&&r.trigger(s,"collisionActive",{pairs:C.collisionActive,timestamp:m.timestamp,delta:u}),C.collisionEnd.length>0&&r.trigger(s,"collisionEnd",{pairs:C.collisionEnd,timestamp:m.timestamp,delta:u}),e._bodiesClearForces(A),r.trigger(s,"afterUpdate",d),s.timing.lastElapsed=t.now()-p,s},e.merge=function(s,u){if(t.extend(s,u),u.world){s.world=u.world,e.clear(s);for(var p=c.allBodies(s.world),S=0;S<p.length;S++){var w=p[S];l.set(w,!1),w.id=t.nextId()}}},e.clear=function(s){f.clear(s.pairs),a.clear(s.detector)},e._bodiesClearForces=function(s){for(var u=s.length,p=0;p<u;p++){var S=s[p];S.force.x=0,S.force.y=0,S.torque=0}},e._bodiesApplyGravity=function(s,u){var p=typeof u.scale<"u"?u.scale:.001,S=s.length;if(!(u.x===0&&u.y===0||p===0))for(var w=0;w<S;w++){var C=s[w];C.isStatic||C.isSleeping||(C.force.y+=C.mass*u.y*p,C.force.x+=C.mass*u.x*p)}},e._bodiesUpdate=function(s,u){for(var p=s.length,S=0;S<p;S++){var w=s[S];w.isStatic||w.isSleeping||n.update(w,u)}},e._bodiesUpdateVelocities=function(s){for(var u=s.length,p=0;p<u;p++)n.updateVelocities(s[p])}})()},function(v,M,h){var e={};v.exports=e;var l=h(3),i=h(0),a=h(1);(function(){e._restingThresh=2,e._restingThreshTangent=Math.sqrt(6),e._positionDampen=.9,e._positionWarming=.8,e._frictionNormalMultiplier=5,e._frictionMaxStatic=Number.MAX_VALUE,e.preSolvePosition=function(f){var r,c,o,t=f.length;for(r=0;r<t;r++)c=f[r],c.isActive&&(o=c.contactCount,c.collision.parentA.totalContacts+=o,c.collision.parentB.totalContacts+=o)},e.solvePosition=function(f,r,c){var o,t,n,s,u,p,S,w,C=e._positionDampen*(c||1),m=i.clamp(r/i._baseDelta,0,1),g=f.length;for(o=0;o<g;o++)t=f[o],!(!t.isActive||t.isSensor)&&(n=t.collision,s=n.parentA,u=n.parentB,p=n.normal,t.separation=n.depth+p.x*(u.positionImpulse.x-s.positionImpulse.x)+p.y*(u.positionImpulse.y-s.positionImpulse.y));for(o=0;o<g;o++)t=f[o],!(!t.isActive||t.isSensor)&&(n=t.collision,s=n.parentA,u=n.parentB,p=n.normal,w=t.separation-t.slop*m,(s.isStatic||u.isStatic)&&(w*=2),s.isStatic||s.isSleeping||(S=C/s.totalContacts,s.positionImpulse.x+=p.x*w*S,s.positionImpulse.y+=p.y*w*S),u.isStatic||u.isSleeping||(S=C/u.totalContacts,u.positionImpulse.x-=p.x*w*S,u.positionImpulse.y-=p.y*w*S))},e.postSolvePosition=function(f){for(var r=e._positionWarming,c=f.length,o=l.translate,t=a.update,n=0;n<c;n++){var s=f[n],u=s.positionImpulse,p=u.x,S=u.y,w=s.velocity;if(s.totalContacts=0,p!==0||S!==0){for(var C=0;C<s.parts.length;C++){var m=s.parts[C];o(m.vertices,u),t(m.bounds,m.vertices,w),m.position.x+=p,m.position.y+=S}s.positionPrev.x+=p,s.positionPrev.y+=S,p*w.x+S*w.y<0?(u.x=0,u.y=0):(u.x*=r,u.y*=r)}}},e.preSolveVelocity=function(f){var r=f.length,c,o;for(c=0;c<r;c++){var t=f[c];if(!(!t.isActive||t.isSensor)){var n=t.contacts,s=t.contactCount,u=t.collision,p=u.parentA,S=u.parentB,w=u.normal,C=u.tangent;for(o=0;o<s;o++){var m=n[o],g=m.vertex,y=m.normalImpulse,d=m.tangentImpulse;if(y!==0||d!==0){var A=w.x*y+C.x*d,P=w.y*y+C.y*d;p.isStatic||p.isSleeping||(p.positionPrev.x+=A*p.inverseMass,p.positionPrev.y+=P*p.inverseMass,p.anglePrev+=p.inverseInertia*((g.x-p.position.x)*P-(g.y-p.position.y)*A)),S.isStatic||S.isSleeping||(S.positionPrev.x-=A*S.inverseMass,S.positionPrev.y-=P*S.inverseMass,S.anglePrev-=S.inverseInertia*((g.x-S.position.x)*P-(g.y-S.position.y)*A))}}}}},e.solveVelocity=function(f,r){var c=r/i._baseDelta,o=c*c,t=o*c,n=-e._restingThresh*c,s=e._restingThreshTangent,u=e._frictionNormalMultiplier*c,p=e._frictionMaxStatic,S=f.length,w,C,m,g;for(m=0;m<S;m++){var y=f[m];if(!(!y.isActive||y.isSensor)){var d=y.collision,A=d.parentA,P=d.parentB,T=d.normal.x,V=d.normal.y,I=d.tangent.x,R=d.tangent.y,B=y.inverseMass,D=y.friction*y.frictionStatic*u,F=y.contacts,L=y.contactCount,O=1/L,b=A.position.x-A.positionPrev.x,W=A.position.y-A.positionPrev.y,z=A.angle-A.anglePrev,G=P.position.x-P.positionPrev.x,X=P.position.y-P.positionPrev.y,$=P.angle-P.anglePrev;for(g=0;g<L;g++){var H=F[g],Q=H.vertex,N=Q.x-A.position.x,K=Q.y-A.position.y,j=Q.x-P.position.x,Z=Q.y-P.position.y,U=b-K*z,de=W+N*z,re=G-Z*$,je=X+j*$,Me=U-re,Te=de-je,xe=T*Me+V*Te,Y=I*Me+R*Te,Ve=y.separation+xe,ye=Math.min(Ve,1);ye=Ve<0?0:ye;var Ee=ye*D;Y<-Ee||Y>Ee?(C=Y>0?Y:-Y,w=y.friction*(Y>0?1:-1)*t,w<-C?w=-C:w>C&&(w=C)):(w=Y,C=p);var Ie=N*V-K*T,Be=j*V-Z*T,Re=O/(B+A.inverseInertia*Ie*Ie+P.inverseInertia*Be*Be),se=(1+y.restitution)*xe*Re;if(w*=Re,xe<n)H.normalImpulse=0;else{var Qe=H.normalImpulse;H.normalImpulse+=se,H.normalImpulse>0&&(H.normalImpulse=0),se=H.normalImpulse-Qe}if(Y<-s||Y>s)H.tangentImpulse=0;else{var Ze=H.tangentImpulse;H.tangentImpulse+=w,H.tangentImpulse<-C&&(H.tangentImpulse=-C),H.tangentImpulse>C&&(H.tangentImpulse=C),w=H.tangentImpulse-Ze}var ae=T*se+I*w,oe=V*se+R*w;A.isStatic||A.isSleeping||(A.positionPrev.x+=ae*A.inverseMass,A.positionPrev.y+=oe*A.inverseMass,A.anglePrev+=(N*oe-K*ae)*A.inverseInertia),P.isStatic||P.isSleeping||(P.positionPrev.x-=ae*P.inverseMass,P.positionPrev.y-=oe*P.inverseMass,P.anglePrev-=(j*oe-Z*ae)*P.inverseInertia)}}}}})()},function(v,M,h){var e={};v.exports=e;var l=h(9),i=h(0);(function(){e.create=function(a){return i.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},a)},e.update=function(a,f,r){var c=l.update,o=l.create,t=l.setActive,n=a.table,s=a.list,u=s.length,p=u,S=a.collisionStart,w=a.collisionEnd,C=a.collisionActive,m=f.length,g=0,y=0,d=0,A,P,T;for(T=0;T<m;T++)A=f[T],P=A.pair,P?(P.isActive&&(C[d++]=P),c(P,A,r)):(P=o(A,r),n[P.id]=P,S[g++]=P,s[p++]=P);for(p=0,u=s.length,T=0;T<u;T++)P=s[T],P.timeUpdated>=r?s[p++]=P:(t(P,!1,r),P.collision.bodyA.sleepCounter>0&&P.collision.bodyB.sleepCounter>0?s[p++]=P:(w[y++]=P,delete n[P.id]));s.length!==p&&(s.length=p),S.length!==g&&(S.length=g),w.length!==y&&(w.length=y),C.length!==d&&(C.length=d)},e.clear=function(a){return a.table={},a.list.length=0,a.collisionStart.length=0,a.collisionActive.length=0,a.collisionEnd.length=0,a}})()},function(v,M,h){var e=v.exports=h(21);e.Axes=h(11),e.Bodies=h(12),e.Body=h(4),e.Bounds=h(1),e.Collision=h(8),e.Common=h(0),e.Composite=h(6),e.Composites=h(22),e.Constraint=h(10),e.Contact=h(16),e.Detector=h(13),e.Engine=h(17),e.Events=h(5),e.Grid=h(23),e.Mouse=h(14),e.MouseConstraint=h(24),e.Pair=h(9),e.Pairs=h(19),e.Plugin=h(15),e.Query=h(25),e.Render=h(26),e.Resolver=h(18),e.Runner=h(27),e.SAT=h(28),e.Sleeping=h(7),e.Svg=h(29),e.Vector=h(2),e.Vertices=h(3),e.World=h(30),e.Engine.run=e.Runner.run,e.Common.deprecated(e.Engine,"run","Engine.run ➤ use Matter.Runner.run(engine) instead")},function(v,M,h){var e={};v.exports=e;var l=h(15),i=h(0);(function(){e.name="matter-js",e.version="0.20.0",e.uses=[],e.used=[],e.use=function(){l.use(e,Array.prototype.slice.call(arguments))},e.before=function(a,f){return a=a.replace(/^Matter./,""),i.chainPathBefore(e,a,f)},e.after=function(a,f){return a=a.replace(/^Matter./,""),i.chainPathAfter(e,a,f)}})()},function(v,M,h){var e={};v.exports=e;var l=h(6),i=h(10),a=h(0),f=h(4),r=h(12),c=a.deprecated;(function(){e.stack=function(o,t,n,s,u,p,S){for(var w=l.create({label:"Stack"}),C=o,m=t,g,y=0,d=0;d<s;d++){for(var A=0,P=0;P<n;P++){var T=S(C,m,P,d,g,y);if(T){var V=T.bounds.max.y-T.bounds.min.y,I=T.bounds.max.x-T.bounds.min.x;V>A&&(A=V),f.translate(T,{x:I*.5,y:V*.5}),C=T.bounds.max.x+u,l.addBody(w,T),g=T,y+=1}else C+=u}m+=A+p,C=o}return w},e.chain=function(o,t,n,s,u,p){for(var S=o.bodies,w=1;w<S.length;w++){var C=S[w-1],m=S[w],g=C.bounds.max.y-C.bounds.min.y,y=C.bounds.max.x-C.bounds.min.x,d=m.bounds.max.y-m.bounds.min.y,A=m.bounds.max.x-m.bounds.min.x,P={bodyA:C,pointA:{x:y*t,y:g*n},bodyB:m,pointB:{x:A*s,y:d*u}},T=a.extend(P,p);l.addConstraint(o,i.create(T))}return o.label+=" Chain",o},e.mesh=function(o,t,n,s,u){var p=o.bodies,S,w,C,m,g;for(S=0;S<n;S++){for(w=1;w<t;w++)C=p[w-1+S*t],m=p[w+S*t],l.addConstraint(o,i.create(a.extend({bodyA:C,bodyB:m},u)));if(S>0)for(w=0;w<t;w++)C=p[w+(S-1)*t],m=p[w+S*t],l.addConstraint(o,i.create(a.extend({bodyA:C,bodyB:m},u))),s&&w>0&&(g=p[w-1+(S-1)*t],l.addConstraint(o,i.create(a.extend({bodyA:g,bodyB:m},u)))),s&&w<t-1&&(g=p[w+1+(S-1)*t],l.addConstraint(o,i.create(a.extend({bodyA:g,bodyB:m},u))))}return o.label+=" Mesh",o},e.pyramid=function(o,t,n,s,u,p,S){return e.stack(o,t,n,s,u,p,function(w,C,m,g,y,d){var A=Math.min(s,Math.ceil(n/2)),P=y?y.bounds.max.x-y.bounds.min.x:0;if(!(g>A)){g=A-g;var T=g,V=n-1-g;if(!(m<T||m>V)){d===1&&f.translate(y,{x:(m+(n%2===1?1:-1))*P,y:0});var I=y?m*P:0;return S(o+I+m*u,C,m,g,y,d)}}})},e.newtonsCradle=function(o,t,n,s,u){for(var p=l.create({label:"Newtons Cradle"}),S=0;S<n;S++){var w=1.9,C=r.circle(o+S*(s*w),t+u,s,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),m=i.create({pointA:{x:o+S*(s*w),y:t},bodyB:C});l.addBody(p,C),l.addConstraint(p,m)}return p},c(e,"newtonsCradle","Composites.newtonsCradle ➤ moved to newtonsCradle example"),e.car=function(o,t,n,s,u){var p=f.nextGroup(!0),S=20,w=-n*.5+S,C=n*.5-S,m=0,g=l.create({label:"Car"}),y=r.rectangle(o,t,n,s,{collisionFilter:{group:p},chamfer:{radius:s*.5},density:2e-4}),d=r.circle(o+w,t+m,u,{collisionFilter:{group:p},friction:.8}),A=r.circle(o+C,t+m,u,{collisionFilter:{group:p},friction:.8}),P=i.create({bodyB:y,pointB:{x:w,y:m},bodyA:d,stiffness:1,length:0}),T=i.create({bodyB:y,pointB:{x:C,y:m},bodyA:A,stiffness:1,length:0});return l.addBody(g,y),l.addBody(g,d),l.addBody(g,A),l.addConstraint(g,P),l.addConstraint(g,T),g},c(e,"car","Composites.car ➤ moved to car example"),e.softBody=function(o,t,n,s,u,p,S,w,C,m){C=a.extend({inertia:1/0},C),m=a.extend({stiffness:.2,render:{type:"line",anchors:!1}},m);var g=e.stack(o,t,n,s,u,p,function(y,d){return r.circle(y,d,w,C)});return e.mesh(g,n,s,S,m),g.label="Soft Body",g},c(e,"softBody","Composites.softBody ➤ moved to softBody and cloth examples")})()},function(v,M,h){var e={};v.exports=e;var l=h(9),i=h(0),a=i.deprecated;(function(){e.create=function(f){var r={buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return i.extend(r,f)},e.update=function(f,r,c,o){var t,n,s,u=c.world,p=f.buckets,S,w,C=!1;for(t=0;t<r.length;t++){var m=r[t];if(!(m.isSleeping&&!o)&&!(u.bounds&&(m.bounds.max.x<u.bounds.min.x||m.bounds.min.x>u.bounds.max.x||m.bounds.max.y<u.bounds.min.y||m.bounds.min.y>u.bounds.max.y))){var g=e._getRegion(f,m);if(!m.region||g.id!==m.region.id||o){(!m.region||o)&&(m.region=g);var y=e._regionUnion(g,m.region);for(n=y.startCol;n<=y.endCol;n++)for(s=y.startRow;s<=y.endRow;s++){w=e._getBucketId(n,s),S=p[w];var d=n>=g.startCol&&n<=g.endCol&&s>=g.startRow&&s<=g.endRow,A=n>=m.region.startCol&&n<=m.region.endCol&&s>=m.region.startRow&&s<=m.region.endRow;!d&&A&&A&&S&&e._bucketRemoveBody(f,S,m),(m.region===g||d&&!A||o)&&(S||(S=e._createBucket(p,w)),e._bucketAddBody(f,S,m))}m.region=g,C=!0}}}C&&(f.pairsList=e._createActivePairsList(f))},a(e,"update","Grid.update ➤ replaced by Matter.Detector"),e.clear=function(f){f.buckets={},f.pairs={},f.pairsList=[]},a(e,"clear","Grid.clear ➤ replaced by Matter.Detector"),e._regionUnion=function(f,r){var c=Math.min(f.startCol,r.startCol),o=Math.max(f.endCol,r.endCol),t=Math.min(f.startRow,r.startRow),n=Math.max(f.endRow,r.endRow);return e._createRegion(c,o,t,n)},e._getRegion=function(f,r){var c=r.bounds,o=Math.floor(c.min.x/f.bucketWidth),t=Math.floor(c.max.x/f.bucketWidth),n=Math.floor(c.min.y/f.bucketHeight),s=Math.floor(c.max.y/f.bucketHeight);return e._createRegion(o,t,n,s)},e._createRegion=function(f,r,c,o){return{id:f+","+r+","+c+","+o,startCol:f,endCol:r,startRow:c,endRow:o}},e._getBucketId=function(f,r){return"C"+f+"R"+r},e._createBucket=function(f,r){var c=f[r]=[];return c},e._bucketAddBody=function(f,r,c){var o=f.pairs,t=l.id,n=r.length,s;for(s=0;s<n;s++){var u=r[s];if(!(c.id===u.id||c.isStatic&&u.isStatic)){var p=t(c,u),S=o[p];S?S[2]+=1:o[p]=[c,u,1]}}r.push(c)},e._bucketRemoveBody=function(f,r,c){var o=f.pairs,t=l.id,n;r.splice(i.indexOf(r,c),1);var s=r.length;for(n=0;n<s;n++){var u=o[t(c,r[n])];u&&(u[2]-=1)}},e._createActivePairsList=function(f){var r,c=f.pairs,o=i.keys(c),t=o.length,n=[],s;for(s=0;s<t;s++)r=c[o[s]],r[2]>0?n.push(r):delete c[o[s]];return n}})()},function(v,M,h){var e={};v.exports=e;var l=h(3),i=h(7),a=h(14),f=h(5),r=h(13),c=h(10),o=h(6),t=h(0),n=h(1);(function(){e.create=function(s,u){var p=(s?s.mouse:null)||(u?u.mouse:null);p||(s&&s.render&&s.render.canvas?p=a.create(s.render.canvas):u&&u.element?p=a.create(u.element):(p=a.create(),t.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var S=c.create({label:"Mouse Constraint",pointA:p.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),w={type:"mouseConstraint",mouse:p,element:null,body:null,constraint:S,collisionFilter:{category:1,mask:4294967295,group:0}},C=t.extend(w,u);return f.on(s,"beforeUpdate",function(){var m=o.allBodies(s.world);e.update(C,m),e._triggerEvents(C)}),C},e.update=function(s,u){var p=s.mouse,S=s.constraint,w=s.body;if(p.button===0){if(S.bodyB)i.set(S.bodyB,!1),S.pointA=p.position;else for(var C=0;C<u.length;C++)if(w=u[C],n.contains(w.bounds,p.position)&&r.canCollide(w.collisionFilter,s.collisionFilter))for(var m=w.parts.length>1?1:0;m<w.parts.length;m++){var g=w.parts[m];if(l.contains(g.vertices,p.position)){S.pointA=p.position,S.bodyB=s.body=w,S.pointB={x:p.position.x-w.position.x,y:p.position.y-w.position.y},S.angleB=w.angle,i.set(w,!1),f.trigger(s,"startdrag",{mouse:p,body:w});break}}}else S.bodyB=s.body=null,S.pointB=null,w&&f.trigger(s,"enddrag",{mouse:p,body:w})},e._triggerEvents=function(s){var u=s.mouse,p=u.sourceEvents;p.mousemove&&f.trigger(s,"mousemove",{mouse:u}),p.mousedown&&f.trigger(s,"mousedown",{mouse:u}),p.mouseup&&f.trigger(s,"mouseup",{mouse:u}),a.clearSourceEvents(u)}})()},function(v,M,h){var e={};v.exports=e;var l=h(2),i=h(8),a=h(1),f=h(12),r=h(3);(function(){e.collides=function(c,o){for(var t=[],n=o.length,s=c.bounds,u=i.collides,p=a.overlaps,S=0;S<n;S++){var w=o[S],C=w.parts.length,m=C===1?0:1;if(p(w.bounds,s))for(var g=m;g<C;g++){var y=w.parts[g];if(p(y.bounds,s)){var d=u(y,c);if(d){t.push(d);break}}}}return t},e.ray=function(c,o,t,n){n=n||1e-100;for(var s=l.angle(o,t),u=l.magnitude(l.sub(o,t)),p=(t.x+o.x)*.5,S=(t.y+o.y)*.5,w=f.rectangle(p,S,u,n,{angle:s}),C=e.collides(w,c),m=0;m<C.length;m+=1){var g=C[m];g.body=g.bodyB=g.bodyA}return C},e.region=function(c,o,t){for(var n=[],s=0;s<c.length;s++){var u=c[s],p=a.overlaps(u.bounds,o);(p&&!t||!p&&t)&&n.push(u)}return n},e.point=function(c,o){for(var t=[],n=0;n<c.length;n++){var s=c[n];if(a.contains(s.bounds,o))for(var u=s.parts.length===1?0:1;u<s.parts.length;u++){var p=s.parts[u];if(a.contains(p.bounds,o)&&r.contains(p.vertices,o)){t.push(s);break}}}return t}})()},function(v,M,h){var e={};v.exports=e;var l=h(4),i=h(0),a=h(6),f=h(1),r=h(5),c=h(2),o=h(14);(function(){var t,n;typeof window<"u"&&(t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(m){window.setTimeout(function(){m(i.now())},1e3/60)},n=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),e._goodFps=30,e._goodDelta=1e3/60,e.create=function(m){var g={engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,timing:{historySize:60,delta:0,deltaHistory:[],lastTime:0,lastTimestamp:0,lastElapsed:0,timestampElapsed:0,timestampElapsedHistory:[],engineDeltaHistory:[],engineElapsedHistory:[],engineUpdatesHistory:[],elapsedHistory:[]},options:{width:800,height:600,pixelRatio:1,background:"#14151f",wireframeBackground:"#14151f",wireframeStrokeStyle:"#bbb",hasBounds:!!m.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showStats:!1,showPerformance:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},y=i.extend(g,m);return y.canvas&&(y.canvas.width=y.options.width||y.canvas.width,y.canvas.height=y.options.height||y.canvas.height),y.mouse=m.mouse,y.engine=m.engine,y.canvas=y.canvas||p(y.options.width,y.options.height),y.context=y.canvas.getContext("2d"),y.textures={},y.bounds=y.bounds||{min:{x:0,y:0},max:{x:y.canvas.width,y:y.canvas.height}},y.controller=e,y.options.showBroadphase=!1,y.options.pixelRatio!==1&&e.setPixelRatio(y,y.options.pixelRatio),i.isElement(y.element)&&y.element.appendChild(y.canvas),y},e.run=function(m){(function g(y){m.frameRequestId=t(g),s(m,y),e.world(m,y),m.context.setTransform(m.options.pixelRatio,0,0,m.options.pixelRatio,0,0),(m.options.showStats||m.options.showDebug)&&e.stats(m,m.context,y),(m.options.showPerformance||m.options.showDebug)&&e.performance(m,m.context,y),m.context.setTransform(1,0,0,1,0,0)})()},e.stop=function(m){n(m.frameRequestId)},e.setPixelRatio=function(m,g){var y=m.options,d=m.canvas;g==="auto"&&(g=S(d)),y.pixelRatio=g,d.setAttribute("data-pixel-ratio",g),d.width=y.width*g,d.height=y.height*g,d.style.width=y.width+"px",d.style.height=y.height+"px"},e.setSize=function(m,g,y){m.options.width=g,m.options.height=y,m.bounds.max.x=m.bounds.min.x+g,m.bounds.max.y=m.bounds.min.y+y,m.options.pixelRatio!==1?e.setPixelRatio(m,m.options.pixelRatio):(m.canvas.width=g,m.canvas.height=y)},e.lookAt=function(m,g,y,d){d=typeof d<"u"?d:!0,g=i.isArray(g)?g:[g],y=y||{x:0,y:0};for(var A={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},P=0;P<g.length;P+=1){var T=g[P],V=T.bounds?T.bounds.min:T.min||T.position||T,I=T.bounds?T.bounds.max:T.max||T.position||T;V&&I&&(V.x<A.min.x&&(A.min.x=V.x),I.x>A.max.x&&(A.max.x=I.x),V.y<A.min.y&&(A.min.y=V.y),I.y>A.max.y&&(A.max.y=I.y))}var R=A.max.x-A.min.x+2*y.x,B=A.max.y-A.min.y+2*y.y,D=m.canvas.height,F=m.canvas.width,L=F/D,O=R/B,b=1,W=1;O>L?W=O/L:b=L/O,m.options.hasBounds=!0,m.bounds.min.x=A.min.x,m.bounds.max.x=A.min.x+R*b,m.bounds.min.y=A.min.y,m.bounds.max.y=A.min.y+B*W,d&&(m.bounds.min.x+=R*.5-R*b*.5,m.bounds.max.x+=R*.5-R*b*.5,m.bounds.min.y+=B*.5-B*W*.5,m.bounds.max.y+=B*.5-B*W*.5),m.bounds.min.x-=y.x,m.bounds.max.x-=y.x,m.bounds.min.y-=y.y,m.bounds.max.y-=y.y,m.mouse&&(o.setScale(m.mouse,{x:(m.bounds.max.x-m.bounds.min.x)/m.canvas.width,y:(m.bounds.max.y-m.bounds.min.y)/m.canvas.height}),o.setOffset(m.mouse,m.bounds.min))},e.startViewTransform=function(m){var g=m.bounds.max.x-m.bounds.min.x,y=m.bounds.max.y-m.bounds.min.y,d=g/m.options.width,A=y/m.options.height;m.context.setTransform(m.options.pixelRatio/d,0,0,m.options.pixelRatio/A,0,0),m.context.translate(-m.bounds.min.x,-m.bounds.min.y)},e.endViewTransform=function(m){m.context.setTransform(m.options.pixelRatio,0,0,m.options.pixelRatio,0,0)},e.world=function(m,g){var y=i.now(),d=m.engine,A=d.world,P=m.canvas,T=m.context,V=m.options,I=m.timing,R=a.allBodies(A),B=a.allConstraints(A),D=V.wireframes?V.wireframeBackground:V.background,F=[],L=[],O,b={timestamp:d.timing.timestamp};if(r.trigger(m,"beforeRender",b),m.currentBackground!==D&&C(m,D),T.globalCompositeOperation="source-in",T.fillStyle="transparent",T.fillRect(0,0,P.width,P.height),T.globalCompositeOperation="source-over",V.hasBounds){for(O=0;O<R.length;O++){var W=R[O];f.overlaps(W.bounds,m.bounds)&&F.push(W)}for(O=0;O<B.length;O++){var z=B[O],G=z.bodyA,X=z.bodyB,$=z.pointA,H=z.pointB;G&&($=c.add(G.position,z.pointA)),X&&(H=c.add(X.position,z.pointB)),!(!$||!H)&&(f.contains(m.bounds,$)||f.contains(m.bounds,H))&&L.push(z)}e.startViewTransform(m),m.mouse&&(o.setScale(m.mouse,{x:(m.bounds.max.x-m.bounds.min.x)/m.options.width,y:(m.bounds.max.y-m.bounds.min.y)/m.options.height}),o.setOffset(m.mouse,m.bounds.min))}else L=B,F=R,m.options.pixelRatio!==1&&m.context.setTransform(m.options.pixelRatio,0,0,m.options.pixelRatio,0,0);!V.wireframes||d.enableSleeping&&V.showSleeping?e.bodies(m,F,T):(V.showConvexHulls&&e.bodyConvexHulls(m,F,T),e.bodyWireframes(m,F,T)),V.showBounds&&e.bodyBounds(m,F,T),(V.showAxes||V.showAngleIndicator)&&e.bodyAxes(m,F,T),V.showPositions&&e.bodyPositions(m,F,T),V.showVelocity&&e.bodyVelocity(m,F,T),V.showIds&&e.bodyIds(m,F,T),V.showSeparations&&e.separations(m,d.pairs.list,T),V.showCollisions&&e.collisions(m,d.pairs.list,T),V.showVertexNumbers&&e.vertexNumbers(m,F,T),V.showMousePosition&&e.mousePosition(m,m.mouse,T),e.constraints(L,T),V.hasBounds&&e.endViewTransform(m),r.trigger(m,"afterRender",b),I.lastElapsed=i.now()-y},e.stats=function(m,g,y){for(var d=m.engine,A=d.world,P=a.allBodies(A),T=0,V=55,I=44,R=0,B=0,D=0;D<P.length;D+=1)T+=P[D].parts.length;var F={Part:T,Body:P.length,Cons:a.allConstraints(A).length,Comp:a.allComposites(A).length,Pair:d.pairs.list.length};g.fillStyle="#0e0f19",g.fillRect(R,B,V*5.5,I),g.font="12px Arial",g.textBaseline="top",g.textAlign="right";for(var L in F){var O=F[L];g.fillStyle="#aaa",g.fillText(L,R+V,B+8),g.fillStyle="#eee",g.fillText(O,R+V,B+26),R+=V}},e.performance=function(m,g){var y=m.engine,d=m.timing,A=d.deltaHistory,P=d.elapsedHistory,T=d.timestampElapsedHistory,V=d.engineDeltaHistory,I=d.engineUpdatesHistory,R=d.engineElapsedHistory,B=y.timing.lastUpdatesPerFrame,D=y.timing.lastDelta,F=u(A),L=u(P),O=u(V),b=u(I),W=u(R),z=u(T),G=z/F||0,X=Math.round(F/D),$=1e3/F||0,H=4,Q=12,N=60,K=34,j=10,Z=69;g.fillStyle="#0e0f19",g.fillRect(0,50,Q*5+N*6+22,K),e.status(g,j,Z,N,H,A.length,Math.round($)+" fps",$/e._goodFps,function(U){return A[U]/F-1}),e.status(g,j+Q+N,Z,N,H,V.length,D.toFixed(2)+" dt",e._goodDelta/D,function(U){return V[U]/O-1}),e.status(g,j+(Q+N)*2,Z,N,H,I.length,B+" upf",Math.pow(i.clamp(b/X||1,0,1),4),function(U){return I[U]/b-1}),e.status(g,j+(Q+N)*3,Z,N,H,R.length,W.toFixed(2)+" ut",1-B*W/e._goodFps,function(U){return R[U]/W-1}),e.status(g,j+(Q+N)*4,Z,N,H,P.length,L.toFixed(2)+" rt",1-L/e._goodFps,function(U){return P[U]/L-1}),e.status(g,j+(Q+N)*5,Z,N,H,T.length,G.toFixed(2)+" x",G*G*G,function(U){return(T[U]/A[U]/G||0)-1})},e.status=function(m,g,y,d,A,P,T,V,I){m.strokeStyle="#888",m.fillStyle="#444",m.lineWidth=1,m.fillRect(g,y+7,d,1),m.beginPath(),m.moveTo(g,y+7-A*i.clamp(.4*I(0),-2,2));for(var R=0;R<d;R+=1)m.lineTo(g+R,y+7-(R<P?A*i.clamp(.4*I(R),-2,2):0));m.stroke(),m.fillStyle="hsl("+i.clamp(25+95*V,0,120)+",100%,60%)",m.fillRect(g,y-7,4,4),m.font="12px Arial",m.textBaseline="middle",m.textAlign="right",m.fillStyle="#eee",m.fillText(T,g+d,y-5)},e.constraints=function(m,g){for(var y=g,d=0;d<m.length;d++){var A=m[d];if(!(!A.render.visible||!A.pointA||!A.pointB)){var P=A.bodyA,T=A.bodyB,V,I;if(P?V=c.add(P.position,A.pointA):V=A.pointA,A.render.type==="pin")y.beginPath(),y.arc(V.x,V.y,3,0,2*Math.PI),y.closePath();else{if(T?I=c.add(T.position,A.pointB):I=A.pointB,y.beginPath(),y.moveTo(V.x,V.y),A.render.type==="spring")for(var R=c.sub(I,V),B=c.perp(c.normalise(R)),D=Math.ceil(i.clamp(A.length/5,12,20)),F,L=1;L<D;L+=1)F=L%2===0?1:-1,y.lineTo(V.x+R.x*(L/D)+B.x*F*4,V.y+R.y*(L/D)+B.y*F*4);y.lineTo(I.x,I.y)}A.render.lineWidth&&(y.lineWidth=A.render.lineWidth,y.strokeStyle=A.render.strokeStyle,y.stroke()),A.render.anchors&&(y.fillStyle=A.render.strokeStyle,y.beginPath(),y.arc(V.x,V.y,3,0,2*Math.PI),y.arc(I.x,I.y,3,0,2*Math.PI),y.closePath(),y.fill())}}},e.bodies=function(m,g,y){var d=y;m.engine;var A=m.options,P=A.showInternalEdges||!A.wireframes,T,V,I,R;for(I=0;I<g.length;I++)if(T=g[I],!!T.render.visible){for(R=T.parts.length>1?1:0;R<T.parts.length;R++)if(V=T.parts[R],!!V.render.visible){if(A.showSleeping&&T.isSleeping?d.globalAlpha=.5*V.render.opacity:V.render.opacity!==1&&(d.globalAlpha=V.render.opacity),V.render.sprite&&V.render.sprite.texture&&!A.wireframes){var B=V.render.sprite,D=w(m,B.texture);d.translate(V.position.x,V.position.y),d.rotate(V.angle),d.drawImage(D,D.width*-B.xOffset*B.xScale,D.height*-B.yOffset*B.yScale,D.width*B.xScale,D.height*B.yScale),d.rotate(-V.angle),d.translate(-V.position.x,-V.position.y)}else{if(V.circleRadius)d.beginPath(),d.arc(V.position.x,V.position.y,V.circleRadius,0,2*Math.PI);else{d.beginPath(),d.moveTo(V.vertices[0].x,V.vertices[0].y);for(var F=1;F<V.vertices.length;F++)!V.vertices[F-1].isInternal||P?d.lineTo(V.vertices[F].x,V.vertices[F].y):d.moveTo(V.vertices[F].x,V.vertices[F].y),V.vertices[F].isInternal&&!P&&d.moveTo(V.vertices[(F+1)%V.vertices.length].x,V.vertices[(F+1)%V.vertices.length].y);d.lineTo(V.vertices[0].x,V.vertices[0].y),d.closePath()}A.wireframes?(d.lineWidth=1,d.strokeStyle=m.options.wireframeStrokeStyle,d.stroke()):(d.fillStyle=V.render.fillStyle,V.render.lineWidth&&(d.lineWidth=V.render.lineWidth,d.strokeStyle=V.render.strokeStyle,d.stroke()),d.fill())}d.globalAlpha=1}}},e.bodyWireframes=function(m,g,y){var d=y,A=m.options.showInternalEdges,P,T,V,I,R;for(d.beginPath(),V=0;V<g.length;V++)if(P=g[V],!!P.render.visible)for(R=P.parts.length>1?1:0;R<P.parts.length;R++){for(T=P.parts[R],d.moveTo(T.vertices[0].x,T.vertices[0].y),I=1;I<T.vertices.length;I++)!T.vertices[I-1].isInternal||A?d.lineTo(T.vertices[I].x,T.vertices[I].y):d.moveTo(T.vertices[I].x,T.vertices[I].y),T.vertices[I].isInternal&&!A&&d.moveTo(T.vertices[(I+1)%T.vertices.length].x,T.vertices[(I+1)%T.vertices.length].y);d.lineTo(T.vertices[0].x,T.vertices[0].y)}d.lineWidth=1,d.strokeStyle=m.options.wireframeStrokeStyle,d.stroke()},e.bodyConvexHulls=function(m,g,y){var d=y,A,P,T;for(d.beginPath(),P=0;P<g.length;P++)if(A=g[P],!(!A.render.visible||A.parts.length===1)){for(d.moveTo(A.vertices[0].x,A.vertices[0].y),T=1;T<A.vertices.length;T++)d.lineTo(A.vertices[T].x,A.vertices[T].y);d.lineTo(A.vertices[0].x,A.vertices[0].y)}d.lineWidth=1,d.strokeStyle="rgba(255,255,255,0.2)",d.stroke()},e.vertexNumbers=function(m,g,y){var d=y,A,P,T;for(A=0;A<g.length;A++){var V=g[A].parts;for(T=V.length>1?1:0;T<V.length;T++){var I=V[T];for(P=0;P<I.vertices.length;P++)d.fillStyle="rgba(255,255,255,0.2)",d.fillText(A+"_"+P,I.position.x+(I.vertices[P].x-I.position.x)*.8,I.position.y+(I.vertices[P].y-I.position.y)*.8)}}},e.mousePosition=function(m,g,y){var d=y;d.fillStyle="rgba(255,255,255,0.8)",d.fillText(g.position.x+"  "+g.position.y,g.position.x+5,g.position.y-5)},e.bodyBounds=function(m,g,y){var d=y;m.engine;var A=m.options;d.beginPath();for(var P=0;P<g.length;P++){var T=g[P];if(T.render.visible)for(var V=g[P].parts,I=V.length>1?1:0;I<V.length;I++){var R=V[I];d.rect(R.bounds.min.x,R.bounds.min.y,R.bounds.max.x-R.bounds.min.x,R.bounds.max.y-R.bounds.min.y)}}A.wireframes?d.strokeStyle="rgba(255,255,255,0.08)":d.strokeStyle="rgba(0,0,0,0.1)",d.lineWidth=1,d.stroke()},e.bodyAxes=function(m,g,y){var d=y;m.engine;var A=m.options,P,T,V,I;for(d.beginPath(),T=0;T<g.length;T++){var R=g[T],B=R.parts;if(R.render.visible)if(A.showAxes)for(V=B.length>1?1:0;V<B.length;V++)for(P=B[V],I=0;I<P.axes.length;I++){var D=P.axes[I];d.moveTo(P.position.x,P.position.y),d.lineTo(P.position.x+D.x*20,P.position.y+D.y*20)}else for(V=B.length>1?1:0;V<B.length;V++)for(P=B[V],I=0;I<P.axes.length;I++)d.moveTo(P.position.x,P.position.y),d.lineTo((P.vertices[0].x+P.vertices[P.vertices.length-1].x)/2,(P.vertices[0].y+P.vertices[P.vertices.length-1].y)/2)}A.wireframes?(d.strokeStyle="indianred",d.lineWidth=1):(d.strokeStyle="rgba(255, 255, 255, 0.4)",d.globalCompositeOperation="overlay",d.lineWidth=2),d.stroke(),d.globalCompositeOperation="source-over"},e.bodyPositions=function(m,g,y){var d=y;m.engine;var A=m.options,P,T,V,I;for(d.beginPath(),V=0;V<g.length;V++)if(P=g[V],!!P.render.visible)for(I=0;I<P.parts.length;I++)T=P.parts[I],d.arc(T.position.x,T.position.y,3,0,2*Math.PI,!1),d.closePath();for(A.wireframes?d.fillStyle="indianred":d.fillStyle="rgba(0,0,0,0.5)",d.fill(),d.beginPath(),V=0;V<g.length;V++)P=g[V],P.render.visible&&(d.arc(P.positionPrev.x,P.positionPrev.y,2,0,2*Math.PI,!1),d.closePath());d.fillStyle="rgba(255,165,0,0.8)",d.fill()},e.bodyVelocity=function(m,g,y){var d=y;d.beginPath();for(var A=0;A<g.length;A++){var P=g[A];if(P.render.visible){var T=l.getVelocity(P);d.moveTo(P.position.x,P.position.y),d.lineTo(P.position.x+T.x,P.position.y+T.y)}}d.lineWidth=3,d.strokeStyle="cornflowerblue",d.stroke()},e.bodyIds=function(m,g,y){var d=y,A,P;for(A=0;A<g.length;A++)if(g[A].render.visible){var T=g[A].parts;for(P=T.length>1?1:0;P<T.length;P++){var V=T[P];d.font="12px Arial",d.fillStyle="rgba(255,255,255,0.5)",d.fillText(V.id,V.position.x+10,V.position.y-10)}}},e.collisions=function(m,g,y){var d=y,A=m.options,P,T,V,I;for(d.beginPath(),V=0;V<g.length;V++)if(P=g[V],!!P.isActive)for(T=P.collision,I=0;I<P.contactCount;I++){var R=P.contacts[I],B=R.vertex;d.rect(B.x-1.5,B.y-1.5,3.5,3.5)}for(A.wireframes?d.fillStyle="rgba(255,255,255,0.7)":d.fillStyle="orange",d.fill(),d.beginPath(),V=0;V<g.length;V++)if(P=g[V],!!P.isActive&&(T=P.collision,P.contactCount>0)){var D=P.contacts[0].vertex.x,F=P.contacts[0].vertex.y;P.contactCount===2&&(D=(P.contacts[0].vertex.x+P.contacts[1].vertex.x)/2,F=(P.contacts[0].vertex.y+P.contacts[1].vertex.y)/2),T.bodyB===T.supports[0].body||T.bodyA.isStatic===!0?d.moveTo(D-T.normal.x*8,F-T.normal.y*8):d.moveTo(D+T.normal.x*8,F+T.normal.y*8),d.lineTo(D,F)}A.wireframes?d.strokeStyle="rgba(255,165,0,0.7)":d.strokeStyle="orange",d.lineWidth=1,d.stroke()},e.separations=function(m,g,y){var d=y,A=m.options,P,T,V,I,R;for(d.beginPath(),R=0;R<g.length;R++)if(P=g[R],!!P.isActive){T=P.collision,V=T.bodyA,I=T.bodyB;var B=1;!I.isStatic&&!V.isStatic&&(B=.5),I.isStatic&&(B=0),d.moveTo(I.position.x,I.position.y),d.lineTo(I.position.x-T.penetration.x*B,I.position.y-T.penetration.y*B),B=1,!I.isStatic&&!V.isStatic&&(B=.5),V.isStatic&&(B=0),d.moveTo(V.position.x,V.position.y),d.lineTo(V.position.x+T.penetration.x*B,V.position.y+T.penetration.y*B)}A.wireframes?d.strokeStyle="rgba(255,165,0,0.5)":d.strokeStyle="orange",d.stroke()},e.inspector=function(m,g){m.engine;var y=m.selected,d=m.render,A=d.options,P;if(A.hasBounds){var T=d.bounds.max.x-d.bounds.min.x,V=d.bounds.max.y-d.bounds.min.y,I=T/d.options.width,R=V/d.options.height;g.scale(1/I,1/R),g.translate(-d.bounds.min.x,-d.bounds.min.y)}for(var B=0;B<y.length;B++){var D=y[B].data;switch(g.translate(.5,.5),g.lineWidth=1,g.strokeStyle="rgba(255,165,0,0.9)",g.setLineDash([1,2]),D.type){case"body":P=D.bounds,g.beginPath(),g.rect(Math.floor(P.min.x-3),Math.floor(P.min.y-3),Math.floor(P.max.x-P.min.x+6),Math.floor(P.max.y-P.min.y+6)),g.closePath(),g.stroke();break;case"constraint":var F=D.pointA;D.bodyA&&(F=D.pointB),g.beginPath(),g.arc(F.x,F.y,10,0,2*Math.PI),g.closePath(),g.stroke();break}g.setLineDash([]),g.translate(-.5,-.5)}m.selectStart!==null&&(g.translate(.5,.5),g.lineWidth=1,g.strokeStyle="rgba(255,165,0,0.6)",g.fillStyle="rgba(255,165,0,0.1)",P=m.selectBounds,g.beginPath(),g.rect(Math.floor(P.min.x),Math.floor(P.min.y),Math.floor(P.max.x-P.min.x),Math.floor(P.max.y-P.min.y)),g.closePath(),g.stroke(),g.fill(),g.translate(-.5,-.5)),A.hasBounds&&g.setTransform(1,0,0,1,0,0)};var s=function(m,g){var y=m.engine,d=m.timing,A=d.historySize,P=y.timing.timestamp;d.delta=g-d.lastTime||e._goodDelta,d.lastTime=g,d.timestampElapsed=P-d.lastTimestamp||0,d.lastTimestamp=P,d.deltaHistory.unshift(d.delta),d.deltaHistory.length=Math.min(d.deltaHistory.length,A),d.engineDeltaHistory.unshift(y.timing.lastDelta),d.engineDeltaHistory.length=Math.min(d.engineDeltaHistory.length,A),d.timestampElapsedHistory.unshift(d.timestampElapsed),d.timestampElapsedHistory.length=Math.min(d.timestampElapsedHistory.length,A),d.engineUpdatesHistory.unshift(y.timing.lastUpdatesPerFrame),d.engineUpdatesHistory.length=Math.min(d.engineUpdatesHistory.length,A),d.engineElapsedHistory.unshift(y.timing.lastElapsed),d.engineElapsedHistory.length=Math.min(d.engineElapsedHistory.length,A),d.elapsedHistory.unshift(d.lastElapsed),d.elapsedHistory.length=Math.min(d.elapsedHistory.length,A)},u=function(m){for(var g=0,y=0;y<m.length;y+=1)g+=m[y];return g/m.length||0},p=function(m,g){var y=document.createElement("canvas");return y.width=m,y.height=g,y.oncontextmenu=function(){return!1},y.onselectstart=function(){return!1},y},S=function(m){var g=m.getContext("2d"),y=window.devicePixelRatio||1,d=g.webkitBackingStorePixelRatio||g.mozBackingStorePixelRatio||g.msBackingStorePixelRatio||g.oBackingStorePixelRatio||g.backingStorePixelRatio||1;return y/d},w=function(m,g){var y=m.textures[g];return y||(y=m.textures[g]=new Image,y.src=g,y)},C=function(m,g){var y=g;/(jpg|gif|png)$/.test(g)&&(y="url("+g+")"),m.canvas.style.background=y,m.canvas.style.backgroundSize="contain",m.currentBackground=g}})()},function(v,M,h){var e={};v.exports=e;var l=h(5),i=h(17),a=h(0);(function(){e._maxFrameDelta=1e3/15,e._frameDeltaFallback=1e3/60,e._timeBufferMargin=1.5,e._elapsedNextEstimate=1,e._smoothingLowerBound=.1,e._smoothingUpperBound=.9,e.create=function(r){var c={delta:16.666666666666668,frameDelta:null,frameDeltaSmoothing:!0,frameDeltaSnapping:!0,frameDeltaHistory:[],frameDeltaHistorySize:100,frameRequestId:null,timeBuffer:0,timeLastTick:null,maxUpdates:null,maxFrameTime:33.333333333333336,lastUpdatesDeferred:0,enabled:!0},o=a.extend(c,r);return o.fps=0,o},e.run=function(r,c){return r.timeBuffer=e._frameDeltaFallback,function o(t){r.frameRequestId=e._onNextFrame(r,o),t&&r.enabled&&e.tick(r,c,t)}(),r},e.tick=function(r,c,o){var t=a.now(),n=r.delta,s=0,u=o-r.timeLastTick;if((!u||!r.timeLastTick||u>Math.max(e._maxFrameDelta,r.maxFrameTime))&&(u=r.frameDelta||e._frameDeltaFallback),r.frameDeltaSmoothing){r.frameDeltaHistory.push(u),r.frameDeltaHistory=r.frameDeltaHistory.slice(-r.frameDeltaHistorySize);var p=r.frameDeltaHistory.slice(0).sort(),S=r.frameDeltaHistory.slice(p.length*e._smoothingLowerBound,p.length*e._smoothingUpperBound),w=f(S);u=w||u}r.frameDeltaSnapping&&(u=1e3/Math.round(1e3/u)),r.frameDelta=u,r.timeLastTick=o,r.timeBuffer+=r.frameDelta,r.timeBuffer=a.clamp(r.timeBuffer,0,r.frameDelta+n*e._timeBufferMargin),r.lastUpdatesDeferred=0;var C=r.maxUpdates||Math.ceil(r.maxFrameTime/n),m={timestamp:c.timing.timestamp};l.trigger(r,"beforeTick",m),l.trigger(r,"tick",m);for(var g=a.now();n>0&&r.timeBuffer>=n*e._timeBufferMargin;){l.trigger(r,"beforeUpdate",m),i.update(c,n),l.trigger(r,"afterUpdate",m),r.timeBuffer-=n,s+=1;var y=a.now()-t,d=a.now()-g,A=y+e._elapsedNextEstimate*d/s;if(s>=C||A>r.maxFrameTime){r.lastUpdatesDeferred=Math.round(Math.max(0,r.timeBuffer/n-e._timeBufferMargin));break}}c.timing.lastUpdatesPerFrame=s,l.trigger(r,"afterTick",m),r.frameDeltaHistory.length>=100&&(r.lastUpdatesDeferred&&Math.round(r.frameDelta/n)>C?a.warnOnce("Matter.Runner: runner reached runner.maxUpdates, see docs."):r.lastUpdatesDeferred&&a.warnOnce("Matter.Runner: runner reached runner.maxFrameTime, see docs."),typeof r.isFixed<"u"&&a.warnOnce("Matter.Runner: runner.isFixed is now redundant, see docs."),(r.deltaMin||r.deltaMax)&&a.warnOnce("Matter.Runner: runner.deltaMin and runner.deltaMax were removed, see docs."),r.fps!==0&&a.warnOnce("Matter.Runner: runner.fps was replaced by runner.delta, see docs."))},e.stop=function(r){e._cancelNextFrame(r)},e._onNextFrame=function(r,c){if(typeof window<"u"&&window.requestAnimationFrame)r.frameRequestId=window.requestAnimationFrame(c);else throw new Error("Matter.Runner: missing required global window.requestAnimationFrame.");return r.frameRequestId},e._cancelNextFrame=function(r){if(typeof window<"u"&&window.cancelAnimationFrame)window.cancelAnimationFrame(r.frameRequestId);else throw new Error("Matter.Runner: missing required global window.cancelAnimationFrame.")};var f=function(r){for(var c=0,o=r.length,t=0;t<o;t+=1)c+=r[t];return c/o||0}})()},function(v,M,h){var e={};v.exports=e;var l=h(8),i=h(0),a=i.deprecated;(function(){e.collides=function(f,r){return l.collides(f,r)},a(e,"collides","SAT.collides ➤ replaced by Collision.collides")})()},function(v,M,h){var e={};v.exports=e,h(1);var l=h(0);(function(){e.pathToVertices=function(i,a){typeof window<"u"&&!("SVGPathSeg"in window)&&l.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var f,r,c,o,t,n,s,u,p,S,w=[],C,m,g=0,y=0,d=0;a=a||15;var A=function(T,V,I){var R=I%2===1&&I>1;if(!p||T!=p.x||V!=p.y){p&&R?(C=p.x,m=p.y):(C=0,m=0);var B={x:C+T,y:m+V};(R||!p)&&(p=B),w.push(B),y=C+T,d=m+V}},P=function(T){var V=T.pathSegTypeAsLetter.toUpperCase();if(V!=="Z"){switch(V){case"M":case"L":case"T":case"C":case"S":case"Q":y=T.x,d=T.y;break;case"H":y=T.x;break;case"V":d=T.y;break}A(y,d,T.pathSegType)}};for(e._svgPathToAbsolute(i),c=i.getTotalLength(),n=[],f=0;f<i.pathSegList.numberOfItems;f+=1)n.push(i.pathSegList.getItem(f));for(s=n.concat();g<c;){if(S=i.getPathSegAtLength(g),t=n[S],t!=u){for(;s.length&&s[0]!=t;)P(s.shift());u=t}switch(t.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":o=i.getPointAtLength(g),A(o.x,o.y,0);break}g+=a}for(f=0,r=s.length;f<r;++f)P(s[f]);return w},e._svgPathToAbsolute=function(i){for(var a,f,r,c,o,t,n=i.pathSegList,s=0,u=0,p=n.numberOfItems,S=0;S<p;++S){var w=n.getItem(S),C=w.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(C))"x"in w&&(s=w.x),"y"in w&&(u=w.y);else switch("x1"in w&&(r=s+w.x1),"x2"in w&&(o=s+w.x2),"y1"in w&&(c=u+w.y1),"y2"in w&&(t=u+w.y2),"x"in w&&(s+=w.x),"y"in w&&(u+=w.y),C){case"m":n.replaceItem(i.createSVGPathSegMovetoAbs(s,u),S);break;case"l":n.replaceItem(i.createSVGPathSegLinetoAbs(s,u),S);break;case"h":n.replaceItem(i.createSVGPathSegLinetoHorizontalAbs(s),S);break;case"v":n.replaceItem(i.createSVGPathSegLinetoVerticalAbs(u),S);break;case"c":n.replaceItem(i.createSVGPathSegCurvetoCubicAbs(s,u,r,c,o,t),S);break;case"s":n.replaceItem(i.createSVGPathSegCurvetoCubicSmoothAbs(s,u,o,t),S);break;case"q":n.replaceItem(i.createSVGPathSegCurvetoQuadraticAbs(s,u,r,c),S);break;case"t":n.replaceItem(i.createSVGPathSegCurvetoQuadraticSmoothAbs(s,u),S);break;case"a":n.replaceItem(i.createSVGPathSegArcAbs(s,u,w.r1,w.r2,w.angle,w.largeArcFlag,w.sweepFlag),S);break;case"z":case"Z":s=a,u=f;break}(C=="M"||C=="m")&&(a=s,f=u)}}})()},function(v,M,h){var e={};v.exports=e;var l=h(6);h(0),function(){e.create=l.create,e.add=l.add,e.remove=l.remove,e.clear=l.clear,e.addComposite=l.addComposite,e.addBody=l.addBody,e.addConstraint=l.addConstraint}()}])})})(gt);export{mt as A,q as C,et as E,At as a,ht as b,Pt as c,wt as d,St as e,yt as f,Ct as i,ee as l};
